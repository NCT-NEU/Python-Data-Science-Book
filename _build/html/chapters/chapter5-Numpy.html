
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chương 5: Kiến thức cơ bản về NumPy &#8212; Khoa học dữ liệu trong Kinh tế và Kinh doanh</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/chapter5-Numpy';</script>
    <link rel="canonical" href="https://www.tomasbeuzen.com/python-programming-for-data-science/chapters/chapter5-Numpy.html" />
    <link rel="icon" href="../_static/favicon2.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chương 6: Giới thiệu về pandas" href="chapter6-pandas.html" />
    <link rel="prev" title="Chương 4: Python cơ bản" href="chapter4-basics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Khoa học dữ liệu trong Kinh tế và Kinh doanh - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Khoa học dữ liệu trong Kinh tế và Kinh doanh - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Khoa học dữ liệu trong Kinh tế và Kinh doanh
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="gioi-thieu-ve-khoa-hoc-du-lieu.html">Chương 1: Các khái niệm cơ bản trong khoa học dữ liệu</a></li>

<li class="toctree-l1"><a class="reference internal" href="nguyen-ly-phan-tich-du-lieu.html">Chương 2: Nguyên lý của phân tích dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="khung-phuong-phap-xay-dung-mo-hinh.html">Chương 3: Khung phương pháp luận trong xây dựng mô hình</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter4-basics.html">Chương 4: Python cơ bản</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chương 5: Kiến thức cơ bản về NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter6-pandas.html">Chương 6: Giới thiệu về <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter7-Import-data.html">Chương 7: Nhập và lưu trữ dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter8-prepare.html">Chương 8: Làm sạch và chuẩn bị dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter9-transform.html">Chương 9: Sắp xếp và biến đổi dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter10-visualization.html">10. Trực quan hóa dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter11-IntroML.html">Chương: Tổng quan về xây dựng mô hình trên dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter12-Supervised.html">Chương 12: Các mô hình học máy có giám sát</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter13-Unsupervised.html">Chương 13: Học máy không giám sát</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practice Exercises</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/chapter1-basics-practice.html">Python Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/chapter2-loops-functions-practice.html">Loops &amp; Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/chapter3-tests-classes-practice.html">Unit Tests &amp; Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/chapter4-style-scripts-imports-practice.html">Style Guides, Scripts, Imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/chapter5-numpy-practice.html">NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/chapter7-pandas-practice.html">Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/chapter8-wrangling-basics-practice.html">Basic Wrangling With Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practice-exercises/chapter9-wrangling-advanced-practice.html">Advanced Wrangling With Pandas</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/TomasBeuzen/python-programming-for-data-science" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/chapter5-Numpy.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chương 5: Kiến thức cơ bản về NumPy</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#doi-tuong-ndarray-cua-numpy">Đối tượng <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> của NumPy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tao-mot-ndarray">Tạo một ndarray</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kieu-du-lieu-cho-ndarray">Kiểu dữ liệu cho ndarray</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-phep-toan-so-hoc-voi-mang-numpy">Các phép toán số học với mảng <code class="docutils literal notranslate"><span class="pre">NumPy</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-so-cua-mang">Chỉ số của mảng</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-muc-hoa-bang-lat-cat-indexing-with-slices">Chỉ mục hóa bằng lát cắt (Indexing with Slices)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-muc-hoa-boolean-boolean-indexing">Chỉ mục hóa Boolean (Boolean Indexing)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-muc-hoa-nang-cao-fancy-indexing">Chỉ mục hóa nâng cao (Fancy Indexing)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chuyen-vi-mang-va-hoan-doi-truc-transposing-arrays-and-swapping-axes">Chuyển vị mảng và Hoán đổi trục (Transposing Arrays and Swapping Axes)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ham-pho-quat-cac-ham-mang-tinh-toan-theo-tung-phan-tu-nhanh-chong">4.2 Hàm phổ quát: Các hàm mảng tính toán theo từng phần tử nhanh chóng</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xu-ly-du-lieu-dua-tren-mang">4.3 Xử lý dữ liệu dựa trên mảng</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-hien-logic-co-dieu-kien-duoi-dang-cac-phep-toan-mang">Thể hiện logic có điều kiện dưới dạng các phép toán mảng</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-phuong-thuc-thong-ke-toan-hoc">Các phương thức thống kê toán học</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-phuong-thuc-cho-mang-boolean">Các phương thức cho mảng Boolean</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sap-xep-sorting">Sắp xếp (Sorting)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-phep-toan-tap-hop-set-operations-cho-mang-1d">Các phép toán tập hợp (Set Operations) cho Mảng 1D</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nhap-va-xuat-file-voi-mang">4.4 Nhập và Xuất file với Mảng</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#luu-va-tai-tep-van-ban">Lưu và tải tệp văn bản</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dai-so-tuyen-tinh">4.5 Đại số tuyến tính</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sinh-so-gia-ngau-nhien-pseudorandom-number-generation">4.6 Sinh số Giả ngẫu nhiên (Pseudorandom Number Generation)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vi-du-buoc-di-ngau-nhien-random-walks">4.7 Ví dụ: Bước đi ngẫu nhiên (Random Walks)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mo-phong-nhieu-buoc-di-ngau-nhien-cung-mot-luc">Mô phỏng nhiều bước đi ngẫu nhiên cùng một lúc</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ket-luan">4.8 Kết luận</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chuong-5-kien-thuc-co-ban-ve-numpy">
<h1>Chương 5: Kiến thức cơ bản về NumPy<a class="headerlink" href="#chuong-5-kien-thuc-co-ban-ve-numpy" title="Link to this heading">#</a></h1>
<hr><p><code class="docutils literal notranslate"><span class="pre">NumPy</span></code>, là viết tắt của Numerical Python, là một trong những thư viện nền tảng quan trọng nhất cho tính toán số học trong Python. Hầu hết các thư viện tính toán cung cấp các chức năng khoa học, như <code class="docutils literal notranslate"><span class="pre">SciPy</span></code> và <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, đều sử dụng cấu trúc mảng từ <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> làm nền tảng. Mặc dù <code class="docutils literal notranslate"><span class="pre">pandas</span></code> cung cấp các cấu trúc dữ liệu bậc cao phong phú và tiện lợi được xây dựng dựa trên <code class="docutils literal notranslate"><span class="pre">NumPy</span></code>, nhưng trong nhiều trường hợp chúng ta vẫn cần phải làm việc trực tiếp với các mảng <code class="docutils literal notranslate"><span class="pre">NumPy</span></code>.</p>
<p>Dưới đây là một số tính năng mà NumPy cung cấp:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ndarray</span></code>, một đối tượng mảng N-chiều hiệu quả, cung cấp các phép toán <strong>vector hóa</strong> nhanh chóng và khả năng lan truyền linh hoạt.</p></li>
<li><p>Các hàm chuẩn để thực hiện các phép toán trên toàn bộ mảng hoặc trên từng phần tử dữ liệu mà không cần viết vòng lặp.</p></li>
<li><p>Các công cụ để đọc và ghi dữ liệu mảng vào đĩa và làm việc với các tệp được <strong>ánh xạ bộ nhớ</strong> (memory-mapped files).</p></li>
<li><p>Các phép toán đại số tuyến tính, biến đổi Fourier và sinh số ngẫu nhiên.</p></li>
</ul>
<p>Ngoài các khả năng tính toán mạnh mẽ mà <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> bổ sung cho Python, một trong những mục tiêu chính của thư viện này khi được tạo ra là để giải quyết vấn đề “hai ngôn ngữ” của Python. Điều này đề cập đến tình huống mà các nhà phát triển cần viết mã <code class="docutils literal notranslate"><span class="pre">C</span></code> hoặc <code class="docutils literal notranslate"><span class="pre">Fortran</span></code> hiệu suất cao để xử lý một lượng lớn dữ liệu, sau đó đưa các câu lệnh đó vào trong Python để dễ sử dụng. <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> được thiết kế để làm cho việc tính toán trên dữ liệu lớn trở nên hiệu quả trong khi vẫn duy trì được tính dễ sử dụng của Python.</p>
<p>Đối với hầu hết các ứng dụng phân tích dữ liệu, mối quan tâm chính đến <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> sẽ tập trung vào các tính năng xử lý mảng của nó, đặc biệt là:</p>
<ul class="simple">
<li><p>Chuẩn bị dữ liệu: làm sạch, thao tác, chuẩn hóa, định hình lại, sắp xếp và lọc.</p></li>
<li><p>Phân tích và mô hình hóa dữ liệu: áp dụng các phép toán và hàm thống kê và tổng hợp cho toàn bộ tập dữ liệu hoặc các tập con cụ thể. Các thuật toán học máy thường yêu cầu dữ liệu đầu vào phải ở dạng mảng <code class="docutils literal notranslate"><span class="pre">NumPy</span></code>.</p></li>
<li><p>Mô phỏng: tạo dữ liệu ngẫu nhiên theo các phân phối đã biết và chạy các mô hình mô phỏng trên dữ liệu đó.</p></li>
<li><p>Các loại thuật toán số khác: ví dụ, xử lý tín hiệu và lọc.</p></li>
</ul>
<p>Mặc dù <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> cung cấp nền tảng tính toán cho nhiều loại ứng dụng khoa học dữ liệu, nhưng bạn đọc sẽ thường sử dụng thư viện <code class="docutils literal notranslate"><span class="pre">pandas</span></code> làm cơ sở cho hầu hết các công việc phân tích dữ liệu, đặc biệt là đối với dữ liệu dạng bảng. <code class="docutils literal notranslate"><span class="pre">pandas</span></code> cũng cung cấp một số chức năng dành riêng cho miền cụ thể hơn, chẳng hạn như xử lý chuỗi thời gian, mà <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> không có. Như vậy, <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> là thành phần quan trọng nhất của hệ sinh thái khoa học dữ liệu Python, nhưng bạn sẽ không nhất thiết phải sử dụng trực tiếp các hàm của <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> mọi lúc.</p>
<p>Trong chương này và xuyên suốt cuốn sách, tôi sẽ sử dụng quy ước chuẩn là nhập <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> dưới tên <code class="docutils literal notranslate"><span class="pre">np</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>Một số người có thể đề xuất không thực hiện <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span></code> và thay vào đó thực hiện <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">numpy</span> <span class="pre">import</span> <span class="pre">*</span></code>. Thực tế thì không gian tên <code class="docutils literal notranslate"><span class="pre">numpy</span></code> rất lớn và chứa nhiều hàm có tên trùng với các hàm Python tích hợp sẵn (như <code class="docutils literal notranslate"><span class="pre">min</span></code> và <code class="docutils literal notranslate"><span class="pre">max</span></code>). Kết quả có thể dẫn đến các vấn đề khó theo dõi nếu bạn không cẩn thận.</p>
<p>Khi bạn thấy <code class="docutils literal notranslate"><span class="pre">np.some_function</span></code>, điều này có nghĩa là một hàm hoặc đối tượng trong không gian tên cấp cao nhất của <code class="docutils literal notranslate"><span class="pre">NumPy</span></code>. Chúng ta sẽ thảo luận chi tiết về một số thành phần chính của <code class="docutils literal notranslate"><span class="pre">NumPy</span></code>, nhưng bạn đọc có thể khám phá không gian tên bằng cách sử dụng IPython hoặc Jupyter với tính năng tự động hoàn thành bằng phím Tab. Ví dụ, nếu bạn nhập <code class="docutils literal notranslate"><span class="pre">np.&lt;TAB&gt;</span></code>, bạn sẽ thấy một danh sách các mô-đun con (như <code class="docutils literal notranslate"><span class="pre">np.random</span></code>, <code class="docutils literal notranslate"><span class="pre">np.fft</span></code>, <code class="docutils literal notranslate"><span class="pre">np.linalg</span></code>, v.v.) và cả các hàm thường được sử dụng.</p>
<section id="doi-tuong-ndarray-cua-numpy">
<h2>Đối tượng <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> của NumPy<a class="headerlink" href="#doi-tuong-ndarray-cua-numpy" title="Link to this heading">#</a></h2>
<p>Một trong những đặc điểm quan trọng của <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> là đối tượng mảng N-chiều, hay <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>. Đây là một đối tượng chứa đa chiều, nhanh chóng và linh hoạt cho các tập dữ liệu lớn trong Python. Các mảng cho phép bạn thực hiện các phép toán toán học trên toàn bộ khối dữ liệu bằng cách sử dụng cú pháp tương tự như các phép toán giữa các phần tử vô hướng (scalar elements). Có rất nhiều điều cần học về các mảng <code class="docutils literal notranslate"><span class="pre">NumPy</span></code>, nhưng chúng ta sẽ bắt đầu với những dạng cơ bản nhất.</p>
<p>Để thấy cách các mảng <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> tạo điều kiện cho các phép toán theo batch với cú pháp tối thiểu, trước tiên hãy xem xét một mảng <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> nhỏ. Giả sử chúng ta có một số dữ liệu trong một danh sách Python:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1_000_000</span><span class="p">)</span>
<span class="n">my_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1_000_000</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Bây giờ, giả sử chúng ta muốn nhân mỗi phần tử với 2. Nếu làm điều này với Python thông thường, chúng ta phải lặp qua danh sách đó:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="n">my_list2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">my_list</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Nếu chúng ta thực hiện thao tác tương tự trên một mảng <code class="docutils literal notranslate"><span class="pre">NumPy</span></code>, nó sẽ trông như thế này:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="n">my_arr2</span> <span class="o">=</span> <span class="n">my_arr</span> <span class="o">*</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>Vấn đề cốt lõi ở đây là thời gian thực hiện phép tính. Chúng ta có thể đo thời gian giữa việc không sử dụng và có sử dụng <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="n">my_list2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">my_list</span><span class="p">]</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;List comprehension: </span><span class="si">{</span><span class="n">t1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">t0</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> s&quot;</span><span class="p">)</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="n">my_arr2</span> <span class="o">=</span> <span class="n">my_arr</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NumPy array: </span><span class="si">{</span><span class="n">t1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">t0</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>List comprehension: 2.5123 s
NumPy array: 0.0985 s
</pre></div>
</div>
</div>
</div>
<p>Các phép toán trên véc-tơ của NumPy thường nhanh hơn so với các vòng lặp Python thuần túy trong bất kỳ loại tính toán nào. Trong các phần sau, chúng ta sẽ được tìm hiểu về cơ chế <strong>broadcasting</strong>, hay lan truyền, một tập hợp các quy tắc mạnh mẽ để áp dụng các phép toán giữa các mảng có kích thước khác nhau.</p>
<p>Một <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> là một đối tượng chứa dữ liệu đồng nhất; nghĩa là, tất cả các phần tử của nó phải có cùng một kiểu. Mỗi đối tượng có một <code class="docutils literal notranslate"><span class="pre">shape</span></code>, một <code class="docutils literal notranslate"><span class="pre">tuple</span></code> biểu thị kích thước của mỗi chiều, và một <code class="docutils literal notranslate"><span class="pre">dtype</span></code>, một đối tượng mô tả <strong>kiểu dữ liệu</strong> của mảng:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">]])</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.5, -0.1,  3. ],
       [ 0. , -3. ,  6.5]])
</pre></div>
</div>
</div>
</div>
<p>Sau đó chúng ta có thể viết:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">*</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 15.,  -1.,  30.],
       [  0., -30.,  65.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">+</span> <span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 3. , -0.2,  6. ],
       [ 0. , -6. , 13. ]])
</pre></div>
</div>
</div>
</div>
<p>Và kiểm tra <code class="docutils literal notranslate"><span class="pre">shape</span></code> và <code class="docutils literal notranslate"><span class="pre">dtype</span></code> của nó:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2, 3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype(&#39;float64&#39;)
</pre></div>
</div>
</div>
</div>
<p>Phần này sẽ giúp bạn làm quen với những điều cơ bản về việc sử dụng mảng <code class="docutils literal notranslate"><span class="pre">NumPy</span></code>.</p>
<section id="tao-mot-ndarray">
<h3>Tạo một ndarray<a class="headerlink" href="#tao-mot-ndarray" title="Link to this heading">#</a></h3>
<hr><p>Cách dễ nhất để tạo một mảng là sử dụng hàm <code class="docutils literal notranslate"><span class="pre">array</span></code>. Chúng ta có thể tạo một mảng như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
<span class="n">arr1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([6. , 7.5, 8. , 0. , 1. ])
</pre></div>
</div>
</div>
</div>
<p>Khi các danh sách lồng nhau sẽ, Python sẽ chuyển đổi thành một mảng nhiều chiều:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]</span>
<span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
<span class="n">arr2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 2, 3, 4],
       [5, 6, 7, 8]])
</pre></div>
</div>
</div>
</div>
<p>Có thể hiểu <code class="docutils literal notranslate"><span class="pre">data2</span></code> là một danh sách các danh sách, mảng <code class="docutils literal notranslate"><span class="pre">arr2</span></code> có hai chiều với <code class="docutils literal notranslate"><span class="pre">shape</span></code> được suy ra từ dữ liệu. Chúng ta có thể xác nhận điều này bằng cách kiểm tra các thuộc tính <code class="docutils literal notranslate"><span class="pre">ndim</span></code> và <code class="docutils literal notranslate"><span class="pre">shape</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr2</span><span class="o">.</span><span class="n">ndim</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2, 4)
</pre></div>
</div>
</div>
</div>
<p>Trừ khi được chỉ định rõ ràng, hàm <code class="docutils literal notranslate"><span class="pre">np.array</span></code> cố gắng suy ra kiểu dữ liệu phù hợp cho mảng mà nó tạo ra. Kiểu dữ liệu được lưu trữ trong một đối tượng <code class="docutils literal notranslate"><span class="pre">dtype</span></code>. Trong hai ví dụ trước chúng ta có:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr1</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype(&#39;float64&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr2</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype(&#39;int64&#39;)
</pre></div>
</div>
</div>
</div>
<p>Ngoài <code class="docutils literal notranslate"><span class="pre">np.array</span></code>, có một số hàm khác để tạo mảng mới. Ví dụ, <code class="docutils literal notranslate"><span class="pre">np.zeros</span></code> và <code class="docutils literal notranslate"><span class="pre">np.ones</span></code> tạo ra các mảng chỉ có các số 0 hoặc số 1 tương ứng với một chiều dài hoặc <code class="docutils literal notranslate"><span class="pre">shape</span></code> cho trước. <code class="docutils literal notranslate"><span class="pre">np.empty</span></code> tạo ra một mảng mà không khởi tạo các giá trị của nó cho bất kỳ giá trị cụ thể nào. Để tạo một mảng có <code class="docutils literal notranslate"><span class="pre">shape</span></code> cao hơn, hãy gán một <code class="docutils literal notranslate"><span class="pre">tuple</span></code> cho <code class="docutils literal notranslate"><span class="pre">shape</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[7.80876461e-312, 3.16202013e-322],
        [0.00000000e+000, 0.00000000e+000],
        [7.78772455e-312, 4.28263786e-037]],

       [[8.23180580e-067, 1.92096969e-052],
        [6.07849098e-067, 1.84703887e+184],
        [9.91422828e+164, 3.89114255e-033]]])
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Chú ý:</strong> Có thể an toàn khi cho rằng <code class="docutils literal notranslate"><span class="pre">np.empty</span></code> sẽ trả về một mảng chứa toàn các giá trị rác. Trong một số trường hợp, nó có thể trả về các mảng chưa được khởi tạo chứa các giá trị 0 hoặc khác 0. Xem tài liệu để biết thêm chi tiết.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">np.arange</span></code> là một phiên bản giống như <code class="docutils literal notranslate"><span class="pre">range</span></code> tích hợp sẵn của Python, nhưng trả về một mảng <code class="docutils literal notranslate"><span class="pre">Numpy</span></code> thay vì một danh sách của Python:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14])
</pre></div>
</div>
</div>
</div>
<p>Xem Bảng … để biết danh sách một phần các hàm tạo mảng chuẩn.</p>
<p><strong>Bảng …: Một số hàm tạo mảng NumPy quan trọng</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Hàm</p></th>
<th class="head"><p>Mô tả</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">array</span></code></p></td>
<td><p>Chuyển đổi dữ liệu đầu vào (danh sách, tuple, mảng hoặc chuỗi khác) thành một ndarray, suy ra một dtype cho ndarray hoặc chỉ định rõ ràng một dtype. Dữ liệu được sao chép theo mặc định.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">asarray</span></code></p></td>
<td><p>Chuyển đổi đầu vào thành ndarray, nhưng không sao chép nếu đầu vào đã là một ndarray có dtype phù hợp.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">arange</span></code></p></td>
<td><p>Giống như <code class="docutils literal notranslate"><span class="pre">range</span></code> tích hợp sẵn nhưng trả về một ndarray thay vì một danh sách.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ones</span></code>, <code class="docutils literal notranslate"><span class="pre">ones_like</span></code></p></td>
<td><p>Tạo một mảng chứa toàn số 1 với <code class="docutils literal notranslate"><span class="pre">shape</span></code> và <code class="docutils literal notranslate"><span class="pre">dtype</span></code> cho trước. <code class="docutils literal notranslate"><span class="pre">ones_like</span></code> lấy một mảng khác và tạo ra một mảng chứa toàn số 1 có cùng <code class="docutils literal notranslate"><span class="pre">shape</span></code> và <code class="docutils literal notranslate"><span class="pre">dtype</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">zeros</span></code>, <code class="docutils literal notranslate"><span class="pre">zeros_like</span></code></p></td>
<td><p>Giống như <code class="docutils literal notranslate"><span class="pre">ones</span></code> và <code class="docutils literal notranslate"><span class="pre">ones_like</span></code> nhưng tạo ra các mảng chứa toàn số 0.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">empty</span></code>, <code class="docutils literal notranslate"><span class="pre">empty_like</span></code></p></td>
<td><p>Tạo các mảng mới bằng cách cấp phát bộ nhớ mới, nhưng không điền bất kỳ giá trị nào như <code class="docutils literal notranslate"><span class="pre">ones</span></code> và <code class="docutils literal notranslate"><span class="pre">zeros</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">full</span></code>, <code class="docutils literal notranslate"><span class="pre">full_like</span></code></p></td>
<td><p>Tạo một mảng có <code class="docutils literal notranslate"><span class="pre">shape</span></code> và <code class="docutils literal notranslate"><span class="pre">dtype</span></code> cho trước với tất cả các giá trị được đặt thành “giá trị điền” được chỉ định. <code class="docutils literal notranslate"><span class="pre">full_like</span></code> lấy một mảng khác và tạo ra một mảng được điền có cùng <code class="docutils literal notranslate"><span class="pre">shape</span></code> và <code class="docutils literal notranslate"><span class="pre">dtype</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">eye</span></code>, <code class="docutils literal notranslate"><span class="pre">identity</span></code></p></td>
<td><p>Tạo một ma trận đơn vị (identity matrix) vuông N × N (1 trên đường chéo và 0 ở những nơi khác).</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="kieu-du-lieu-cho-ndarray">
<h3>Kiểu dữ liệu cho ndarray<a class="headerlink" href="#kieu-du-lieu-cho-ndarray" title="Link to this heading">#</a></h3>
<p><em>Kiểu dữ liệu</em> hay <code class="docutils literal notranslate"><span class="pre">dtype</span></code> là một đối tượng đặc biệt chứa thông tin (hoặc <em>siêu dữ liệu</em>, dữ liệu về dữ liệu) mà <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> cần để diễn giải một khối bộ nhớ là một loại dữ liệu cụ thể:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr1_dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">arr2_dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">arr1_dtype</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype(&#39;float64&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr2_dtype</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype(&#39;int32&#39;)
</pre></div>
</div>
</div>
</div>
<p>Các <code class="docutils literal notranslate"><span class="pre">dtype</span></code> là lý do tại sao <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> rất mạnh mẽ và linh hoạt. Trong hầu hết các trường hợp, <code class="docutils literal notranslate"><span class="pre">dtype</span></code> giúp dễ dàng đọc và ghi dữ liệu dưới dạng nhị phân vào máy và cũng dễ dàng kết nối với các câu lệnh được viết bằng các ngôn ngữ như <code class="docutils literal notranslate"><span class="pre">C</span></code> hoặc <code class="docutils literal notranslate"><span class="pre">Fortran</span></code>.</p>
<p>Các <code class="docutils literal notranslate"><span class="pre">dtype</span></code> kiểu số được đặt tên giống nhau: một tên kiểu, <code class="docutils literal notranslate"><span class="pre">float</span></code> hoặc <code class="docutils literal notranslate"><span class="pre">int</span></code>, theo sau là một số cho biết số bit trên mỗi phần tử. Bạn đọc xem Bảng dưới đây để biết danh sách đầy đủ các <code class="docutils literal notranslate"><span class="pre">dtype</span></code> được hỗ trợ.</p>
<p><strong>Bảng …: Các kiểu dữ liệu NumPy</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Kiểu</p></th>
<th class="head"><p>Mã kiểu</p></th>
<th class="head"><p>Mô tả</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">int8</span></code>, <code class="docutils literal notranslate"><span class="pre">uint8</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">i1</span></code>, <code class="docutils literal notranslate"><span class="pre">u1</span></code></p></td>
<td><p>Số nguyên 8 bit có dấu và không dấu</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">int16</span></code>, <code class="docutils literal notranslate"><span class="pre">uint16</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">i2</span></code>, <code class="docutils literal notranslate"><span class="pre">u2</span></code></p></td>
<td><p>Số nguyên 16 bit có dấu và không dấu</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">int32</span></code>, <code class="docutils literal notranslate"><span class="pre">uint32</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">i4</span></code>, <code class="docutils literal notranslate"><span class="pre">u4</span></code></p></td>
<td><p>Số nguyên 32 bit có dấu và không dấu</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">int64</span></code>, <code class="docutils literal notranslate"><span class="pre">uint64</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">i8</span></code>, <code class="docutils literal notranslate"><span class="pre">u8</span></code></p></td>
<td><p>Số nguyên 64 bit có dấu và không dấu</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">float16</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">f2</span></code></p></td>
<td><p>Số thực dấu phẩy động nửa độ chính xác (half-precision)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">float32</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">f4</span></code> hoặc <code class="docutils literal notranslate"><span class="pre">f</span></code></p></td>
<td><p>Số thực dấu phẩy động đơn độ chính xác (single-precision) tiêu chuẩn; tương thích với <code class="docutils literal notranslate"><span class="pre">float</span></code> trong C</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">float64</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">f8</span></code> hoặc <code class="docutils literal notranslate"><span class="pre">d</span></code></p></td>
<td><p>Số thực dấu phẩy động độ chính xác kép (double-precision) tiêu chuẩn; tương thích với <code class="docutils literal notranslate"><span class="pre">double</span></code> trong C và <code class="docutils literal notranslate"><span class="pre">float</span></code> trong Python</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">float128</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">f16</span></code> hoặc <code class="docutils literal notranslate"><span class="pre">g</span></code></p></td>
<td><p>Số thực dấu phẩy động độ chính xác mở rộng (extended-precision)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">complex64</span></code>, <code class="docutils literal notranslate"><span class="pre">complex128</span></code>, <code class="docutils literal notranslate"><span class="pre">complex256</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">c8</span></code>, <code class="docutils literal notranslate"><span class="pre">c16</span></code>, <code class="docutils literal notranslate"><span class="pre">c32</span></code></p></td>
<td><p>Số phức được biểu diễn bằng hai số thực dấu phẩy động 32, 64, hoặc 128 bit tương ứng</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">?</span></code></p></td>
<td><p>Kiểu Boolean lưu trữ các giá trị <code class="docutils literal notranslate"><span class="pre">True</span></code> và <code class="docutils literal notranslate"><span class="pre">False</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">object</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">O</span></code></p></td>
<td><p>Kiểu đối tượng Python; một giá trị có thể là bất kỳ đối tượng Python nào</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">string_</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">S</span></code></p></td>
<td><p>Kiểu chuỗi ASCII có độ dài cố định (ví dụ, để khớp với <code class="docutils literal notranslate"><span class="pre">dtype</span></code> khi đọc một tệp). Độ dài của chuỗi được chỉ định bởi số theo sau, ví dụ, <code class="docutils literal notranslate"><span class="pre">S10</span></code> là một chuỗi 10 ký tự. NumPy không cung cấp <code class="docutils literal notranslate"><span class="pre">dtype</span></code> chuỗi Unicode có độ dài cố định.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">unicode_</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">U</span></code></p></td>
<td><p>Kiểu Unicode có độ dài cố định (ví dụ, <code class="docutils literal notranslate"><span class="pre">U10</span></code>). NumPy không cung cấp <code class="docutils literal notranslate"><span class="pre">dtype</span></code> chuỗi Unicode có độ dài thay đổi, không giống như pandas.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Bạn có thể chuyển đổi (cast) một mảng từ <code class="docutils literal notranslate"><span class="pre">dtype</span></code> này sang <code class="docutils literal notranslate"><span class="pre">dtype</span></code> khác bằng cách sử dụng phương thức <code class="docutils literal notranslate"><span class="pre">astype</span></code> của <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_astype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">arr_astype</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype(&#39;int64&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">float_arr</span> <span class="o">=</span> <span class="n">arr_astype</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">float_arr</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype(&#39;float64&#39;)
</pre></div>
</div>
</div>
</div>
<p>Trong ví dụ này, các số nguyên được đổi kiểu thành số thực dấu phẩy động. Nếu tôi ép kiểu một số số thực dấu phẩy động thành kiểu số nguyên, phần thập phân sẽ bị cắt bỏ:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_fp_to_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">12.9</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">])</span>
<span class="n">arr_fp_to_int</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 3.7, -1.2, -2.6,  0.5, 12.9, 10.1])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_fp_to_int</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 3, -1, -2,  0, 12, 10], dtype=int32)
</pre></div>
</div>
</div>
</div>
<p>Nếu bạn có một mảng các chuỗi biểu diễn các số, bạn có thể sử dụng <code class="docutils literal notranslate"><span class="pre">astype</span></code> để chuyển đổi chúng thành dạng số:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numeric_strings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;1.25&quot;</span><span class="p">,</span> <span class="s2">&quot;-9.6&quot;</span><span class="p">,</span> <span class="s2">&quot;42&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">string_</span><span class="p">)</span>
<span class="n">numeric_strings</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="c1"># NumPy sẽ tự động suy ra np.float64</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">27</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">numeric_strings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;1.25&quot;</span><span class="p">,</span> <span class="s2">&quot;-9.6&quot;</span><span class="p">,</span> <span class="s2">&quot;42&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">string_</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">numeric_strings</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="c1"># NumPy sẽ tự động suy ra np.float64</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python313\Lib\site-packages\numpy\__init__.py:413,</span> in <span class="ni">__getattr__</span><span class="nt">(attr)</span>
<span class="g g-Whitespace">    </span><span class="mi">410</span>     <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">__former_attrs__</span><span class="p">[</span><span class="n">attr</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">412</span> <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">__expired_attributes__</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">413</span>     <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">414</span>         <span class="sa">f</span><span class="s2">&quot;`np.</span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">` was removed in the NumPy 2.0 release. &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">415</span>         <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">__expired_attributes__</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">416</span>         <span class="n">name</span><span class="o">=</span><span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">417</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">419</span> <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s2">&quot;chararray&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">420</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">421</span>         <span class="s2">&quot;`np.chararray` is deprecated and will be removed from &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">422</span>         <span class="s2">&quot;the main namespace in the future. Use an array with a string &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">423</span>         <span class="s2">&quot;or bytes dtype instead.&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="ne">AttributeError</span>: `np.string_` was removed in the NumPy 2.0 release. Use `np.bytes_` instead.
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Chú ý:</strong> Việc gọi <code class="docutils literal notranslate"><span class="pre">astype</span></code> <em>luôn</em> tạo ra một mảng mới (một bản sao của dữ liệu), ngay cả khi <code class="docutils literal notranslate"><span class="pre">dtype</span></code> mới giống với <code class="docutils literal notranslate"><span class="pre">dtype</span></code> cũ.</p>
</div></blockquote>
<p>Bạn đọc cần lưu ý khi sử dụng <code class="docutils literal notranslate"><span class="pre">dtype</span></code> <code class="docutils literal notranslate"><span class="pre">numpy.string_</span></code>, vì dữ liệu chuỗi trong <code class="docutils literal notranslate"><span class="pre">Numpy</span></code> có độ dài cố định và có thể bị cắt bớt mà không có cảnh báo.</p>
<p>Nếu việc đổi kiểu không thành công vì một lý do nào đó, một <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> sẽ được đưa ra.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">int_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">calibers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.22</span><span class="p">,</span> <span class="mf">.270</span><span class="p">,</span> <span class="mf">.357</span><span class="p">,</span> <span class="mf">.380</span><span class="p">,</span> <span class="mf">.44</span><span class="p">,</span> <span class="mf">.50</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">int_array</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">calibers</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Bạn cũng có thể sử dụng mã kiểu <code class="docutils literal notranslate"><span class="pre">dtype</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">empty_uint32</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;u4&quot;</span><span class="p">)</span>
<span class="n">empty_uint32</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Lưu ý:</strong> Nếu bạn gặp khó khăn trong việc tìm ra <code class="docutils literal notranslate"><span class="pre">dtype</span></code> nào nên sử dụng với dữ liệu của mình thì không cần phải quá quan tâm. Bạn có thể dung <code class="docutils literal notranslate"><span class="pre">float64</span></code> cho hầu hết dữ liệu số thực dấu phẩy động. Việc sử dụng các <code class="docutils literal notranslate"><span class="pre">dtype</span></code> như <code class="docutils literal notranslate"><span class="pre">float32</span></code> thường là để tiết kiệm bộ nhớ khi làm việc với các tập dữ liệu rất lớn.</p>
</div></blockquote>
</section>
<section id="cac-phep-toan-so-hoc-voi-mang-numpy">
<h3>Các phép toán số học với mảng <code class="docutils literal notranslate"><span class="pre">NumPy</span></code><a class="headerlink" href="#cac-phep-toan-so-hoc-voi-mang-numpy" title="Link to this heading">#</a></h3>
<p>Các mảng rất quan trọng vì chúng cho phép chúng ta thể hiện các phép toán theo nhóm trên dữ liệu mà không cần viết bất kỳ vòng lặp <code class="docutils literal notranslate"><span class="pre">for</span></code> nào. <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> gọi tính năng này là <strong>véc-tơ hóa</strong> (vectorization). Bất kỳ phép toán số học nào giữa các mảng có kích thước bằng nhau đều áp dụng phép toán đó theo từng phần tử (element-wise):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_arith</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">]])</span>
<span class="n">arr_arith</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_arith</span> <span class="o">*</span> <span class="n">arr_arith</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_arith</span> <span class="o">-</span> <span class="n">arr_arith</span>
</pre></div>
</div>
</div>
</div>
<p>Các phép toán số học với các đại lượng vô hướng (scalar) truyền giá trị vô hướng đó cho mỗi phần tử trong mảng khi thực hiện phép toán:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">/</span> <span class="n">arr_arith</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_arith</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>Các phép so sánh giữa các mảng có cùng kích thước tạo ra một mảng kiểu logic</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr2_arith</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">12.</span><span class="p">]])</span>
<span class="n">arr2_arith</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr2_arith</span> <span class="o">&gt;</span> <span class="n">arr_arith</span>
</pre></div>
</div>
</div>
</div>
<p>Việc thực hiện các phép toán giữa các mảng có kích thước khác nhau được gọi là <em>broadcasting</em> và sẽ được thảo luận chi tiết hơn trong phần sau</p>
</section>
<section id="chi-so-cua-mang">
<h3>Chỉ số của mảng<a class="headerlink" href="#chi-so-cua-mang" title="Link to this heading">#</a></h3>
<p>Chỉ số của mảng <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> là một chủ đề rộng, vì có nhiều cách bạn có thể chọn một tập con dữ liệu của mình hoặc các phần tử riêng lẻ. Các mảng một chiều khá đơn giản; về bề ngoài, chúng hoạt động tương tự như một <code class="docutils literal notranslate"><span class="pre">list</span></code> trong Python:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_slice_basic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">arr_slice_basic</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_slice_basic</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_slice_basic</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_slice_basic</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">arr_slice_basic</span>
</pre></div>
</div>
</div>
</div>
<p>Như bạn thấy, nếu bạn gán một giá trị vô hướng cho một lát cắt, như trong <code class="docutils literal notranslate"><span class="pre">arr[5:8]</span> <span class="pre">=</span> <span class="pre">12</span></code>, giá trị đó được truyền (hoặc <em>broadcasted</em>) cho toàn bộ lựa chọn. Sự khác biệt quan trọng đầu tiên so với danh sách Python tích hợp sẵn là các lát cắt mảng là các <em>khung nhìn</em> (views) trên mảng gốc. Điều này có nghĩa là dữ liệu không được sao chép, và bất kỳ sửa đổi nào đối với khung nhìn sẽ được phản ánh trong mảng nguồn. Để cung cấp cho bạn một ví dụ về điều này, trước tiên tôi tạo một lát cắt của <code class="docutils literal notranslate"><span class="pre">arr_slice_basic</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_slice_view</span> <span class="o">=</span> <span class="n">arr_slice_basic</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
<span class="n">arr_slice_view</span>
</pre></div>
</div>
</div>
</div>
<p>Bây giờ, khi tôi thay đổi các giá trị trong <code class="docutils literal notranslate"><span class="pre">arr_slice_view</span></code>, các thay đổi đó được phản ánh trong mảng gốc <code class="docutils literal notranslate"><span class="pre">arr_slice_basic</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_slice_view</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12345</span>
<span class="n">arr_slice_basic</span>
</pre></div>
</div>
</div>
</div>
<p>Gán <code class="docutils literal notranslate"><span class="pre">[:]</span></code> sẽ gán cho tất cả các giá trị trong một mảng:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_slice_view</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">arr_slice_basic</span>
</pre></div>
</div>
</div>
</div>
<p>Nếu bạn muốn một bản sao của một lát cắt của một <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> thay vì một khung nhìn, bạn sẽ cần phải sao chép mảng một cách rõ ràng—ví dụ, <code class="docutils literal notranslate"><span class="pre">arr_slice_basic[5:8].copy()</span></code>.</p>
<p>Với các mảng có chiều cao hơn, bạn có nhiều tùy chọn hơn. Trong một mảng hai chiều, các phần tử tại mỗi chỉ mục không phải là các đại lượng vô hướng mà là các mảng một chiều:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<span class="n">arr2d</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Do đó, các phần tử riêng lẻ có thể được truy cập bằng cách sử dụng các chỉ mục đệ quy. Nhưng điều đó hơi dài dòng, vì vậy bạn có thể truyền một danh sách các chỉ mục được phân tách bằng dấu phẩy để chọn một phần tử riêng lẻ. Vì vậy, những điều sau đây là tương đương:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr2d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr2d</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Xem Hình 4.1 để biết minh họa về việc chỉ mục hóa trên một mảng hai chiều. Tôi thấy hữu ích khi nghĩ về trục 0 là “hàng” và trục 1 là “cột”.</p>
<p><strong>Hình 4.1: Chỉ mục hóa các phần tử trong một mảng NumPy</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>          <span class="n">Trục</span> <span class="mi">1</span>
        <span class="o">--------&gt;</span>
       <span class="o">|</span> <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>
<span class="n">Trục</span> <span class="mi">0</span> <span class="o">|</span> <span class="o">--------</span>
  <span class="o">|</span>    <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>
  <span class="o">|</span>    <span class="o">|</span> <span class="mi">1</span> <span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>
  <span class="n">V</span>    <span class="o">|</span> <span class="mi">2</span> <span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>
       <span class="o">--------</span>
</pre></div>
</div>
<p>(Hình ảnh này khó tái tạo chính xác bằng văn bản, nhưng ý tưởng là <code class="docutils literal notranslate"><span class="pre">arr2d[hàng,</span> <span class="pre">cột]</span></code>)</p>
<p>Trong các mảng đa chiều, nếu bạn bỏ qua các chỉ mục sau, đối tượng được trả về sẽ là một <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> có chiều thấp hơn bao gồm tất cả dữ liệu dọc theo các chiều cao hơn. Vì vậy, trong mảng 2 × 2 × 3 <code class="docutils literal notranslate"><span class="pre">arr3d</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr3d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]])</span>
<span class="n">arr3d</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">arr3d[0]</span></code> là một mảng 2 × 3:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr3d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Cả các giá trị vô hướng và các mảng đều có thể được gán cho <code class="docutils literal notranslate"><span class="pre">arr3d[0]</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">old_values</span> <span class="o">=</span> <span class="n">arr3d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">arr3d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">arr3d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr3d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_values</span>
<span class="n">arr3d</span>
</pre></div>
</div>
</div>
</div>
<p>Tương tự, <code class="docutils literal notranslate"><span class="pre">arr3d[1,</span> <span class="pre">0]</span></code> cung cấp cho bạn tất cả các giá trị có chỉ mục bắt đầu bằng <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">0)</span></code>, tạo thành một mảng một chiều:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr3d</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Biểu thức này giống như khi chúng ta chỉ mục hóa <code class="docutils literal notranslate"><span class="pre">arr3d[1]</span></code> và sau đó chỉ mục hóa kết quả đó:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">arr3d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Lưu ý rằng trong tất cả các trường hợp chọn dữ liệu này, các mảng được trả về là các khung nhìn.</p>
<section id="chi-muc-hoa-bang-lat-cat-indexing-with-slices">
<h4>Chỉ mục hóa bằng lát cắt (Indexing with Slices)<a class="headerlink" href="#chi-muc-hoa-bang-lat-cat-indexing-with-slices" title="Link to this heading">#</a></h4>
<p>Giống như các đối tượng một chiều như danh sách Python, <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> có thể được cắt lát bằng cú pháp quen thuộc:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_slice_basic</span> <span class="c1"># arr_slice_basic đã được định nghĩa ở trên: np.arange(10) và đã bị thay đổi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_slice_basic</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Hãy xem xét <code class="docutils literal notranslate"><span class="pre">arr2d</span></code> từ trước. Bạn có thể truyền nhiều lát cắt giống như bạn có thể truyền nhiều chỉ mục:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr2d</span> <span class="c1"># arr2d đã được định nghĩa ở trên</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr2d</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Bạn có thể truyền nhiều lát cắt (cùng với việc trộn các chỉ mục). Ví dụ:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr2d</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<p>Khi cắt lát như thế này, bạn luôn nhận được các khung nhìn mảng có cùng số chiều. Bằng cách trộn các chỉ mục số nguyên và lát cắt, bạn có thể nhận được các lát cắt có chiều thấp hơn.</p>
<p>Ví dụ, tôi có thể chọn hàng thứ hai nhưng chỉ hai cột đầu tiên:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr2d</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Tương tự, tôi có thể chọn cột thứ ba nhưng chỉ hai hàng đầu tiên:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr2d</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Xem Hình 4.2 để biết minh họa. Lưu ý rằng dấu hai chấm (<code class="docutils literal notranslate"><span class="pre">:</span></code>) một mình có nghĩa là lấy toàn bộ trục, vì vậy bạn có thể cắt lát chỉ các chiều cao hơn như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr2d</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Hình 4.2: Các lựa chọn mảng hai chiều từ các lát cắt</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>      <span class="n">arr2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([,,])</span>

      <span class="n">arr2d</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>   <span class="o">-&gt;</span>  <span class="p">[,]</span>
      <span class="n">arr2d</span>        <span class="o">-&gt;</span> 
      <span class="n">arr2d</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>     <span class="o">-&gt;</span> 
      <span class="n">arr2d</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>    <span class="o">-&gt;</span> 
      <span class="n">arr2d</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>    <span class="o">-&gt;</span>  <span class="p">[,,]</span>
      <span class="n">arr2d</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>    <span class="o">-&gt;</span> 
      <span class="n">arr2d</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>  <span class="o">-&gt;</span>  <span class="p">[]</span>
</pre></div>
</div>
<p>(Hình ảnh trực quan hóa các lát cắt khác nhau trên một mảng 3x3)</p>
<p>Tất nhiên, việc gán cho một biểu thức lát cắt sẽ gán cho toàn bộ lựa chọn:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr2d_copy</span> <span class="o">=</span> <span class="n">arr2d</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># Tạo bản sao để không ảnh hưởng arr2d gốc cho các ví dụ sau</span>
<span class="n">arr2d_copy</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">arr2d_copy</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="chi-muc-hoa-boolean-boolean-indexing">
<h3>Chỉ mục hóa Boolean (Boolean Indexing)<a class="headerlink" href="#chi-muc-hoa-boolean-boolean-indexing" title="Link to this heading">#</a></h3>
<p>Hãy xem xét một ví dụ trong đó chúng ta có một số dữ liệu trong một mảng và một mảng các tên với các bản sao. Tôi sẽ sử dụng các hàm của <code class="docutils literal notranslate"><span class="pre">numpy.random</span></code> để tạo một số dữ liệu ngẫu nhiên được phân phối chuẩn:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Joe&quot;</span><span class="p">,</span> <span class="s2">&quot;Will&quot;</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Will&quot;</span><span class="p">,</span> <span class="s2">&quot;Joe&quot;</span><span class="p">,</span> <span class="s2">&quot;Joe&quot;</span><span class="p">])</span>
<span class="n">data_bool</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">names</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_bool</span>
</pre></div>
</div>
</div>
</div>
<p>Giả sử mỗi tên tương ứng với một hàng trong mảng <code class="docutils literal notranslate"><span class="pre">data_bool</span></code> và chúng ta muốn chọn tất cả các hàng có tên tương ứng là <code class="docutils literal notranslate"><span class="pre">'Bob'</span></code>. Giống như các phép toán số học, các phép so sánh với các mảng (chẳng hạn như <code class="docutils literal notranslate"><span class="pre">==</span></code>) cũng được vector hóa. Do đó, việc so sánh <code class="docutils literal notranslate"><span class="pre">names</span></code> với chuỗi <code class="docutils literal notranslate"><span class="pre">'Bob'</span></code> tạo ra một mảng boolean:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">==</span> <span class="s2">&quot;Bob&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Mảng boolean này có thể được truyền khi chỉ mục hóa mảng:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_bool</span><span class="p">[</span><span class="n">names</span> <span class="o">==</span> <span class="s2">&quot;Bob&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Mảng boolean phải có cùng độ dài với trục mảng mà nó đang chỉ mục hóa. Bạn thậm chí có thể trộn và kết hợp các mảng boolean và các lát cắt hoặc các số nguyên (một sự pha trộn mà sẽ được thảo luận chi tiết hơn trong Phụ lục A).</p>
<blockquote>
<div><p><strong>Chú ý:</strong> Chỉ mục hóa boolean, không giống như cắt lát, <em>luôn</em> tạo ra một bản sao của dữ liệu, ngay cả khi mảng được trả về không thay đổi.</p>
</div></blockquote>
<blockquote>
<div><p><strong>Mẹo:</strong> Từ khóa <code class="docutils literal notranslate"><span class="pre">and</span></code> và <code class="docutils literal notranslate"><span class="pre">or</span></code> của Python không hoạt động với các mảng boolean. Thay vào đó, hãy sử dụng <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> (và) và <code class="docutils literal notranslate"><span class="pre">|</span></code> (hoặc).</p>
</div></blockquote>
<p>Trong những trường hợp này, tôi chọn các hàng mà <code class="docutils literal notranslate"><span class="pre">names</span> <span class="pre">==</span> <span class="pre">&quot;Bob&quot;</span></code> và chỉ mục hóa các cột:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_bool</span><span class="p">[</span><span class="n">names</span> <span class="o">==</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_bool</span><span class="p">[</span><span class="n">names</span> <span class="o">==</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Để chọn mọi thứ ngoại trừ <code class="docutils literal notranslate"><span class="pre">'Bob'</span></code>, bạn có thể sử dụng <code class="docutils literal notranslate"><span class="pre">!=</span></code> hoặc phủ định điều kiện bằng <code class="docutils literal notranslate"><span class="pre">~</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">!=</span> <span class="s2">&quot;Bob&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">~</span><span class="p">(</span><span class="n">names</span> <span class="o">==</span> <span class="s2">&quot;Bob&quot;</span><span class="p">)</span> <span class="c1"># cách viết khác</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_bool</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">names</span> <span class="o">==</span> <span class="s2">&quot;Bob&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>Toán tử <code class="docutils literal notranslate"><span class="pre">~</span></code> có thể hữu ích khi bạn muốn đảo ngược một điều kiện chung:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="n">names</span> <span class="o">==</span> <span class="s2">&quot;Bob&quot;</span>
<span class="n">data_bool</span><span class="p">[</span><span class="o">~</span><span class="n">cond</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Để chọn hai trong ba tên, hãy kết hợp nhiều điều kiện boolean bằng toán tử số học <code class="docutils literal notranslate"><span class="pre">|</span></code> (hoặc):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">names</span> <span class="o">==</span> <span class="s2">&quot;Bob&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">names</span> <span class="o">==</span> <span class="s2">&quot;Will&quot;</span><span class="p">)</span>
<span class="n">mask</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_bool</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Việc chọn dữ liệu từ một mảng bằng chỉ mục hóa boolean luôn tạo ra một bản sao của dữ liệu, ngay cả khi mảng được trả về giống hệt mảng gốc.</p>
<p>Việc đặt giá trị bằng mảng boolean hoạt động theo cách thông thường. Để đặt tất cả các giá trị âm trong <code class="docutils literal notranslate"><span class="pre">data_bool</span></code> thành 0, chúng ta chỉ cần làm:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_bool_copy</span> <span class="o">=</span> <span class="n">data_bool</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># Tạo bản sao để không ảnh hưởng data_bool gốc</span>
<span class="n">data_bool_copy</span><span class="p">[</span><span class="n">data_bool_copy</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data_bool_copy</span>
</pre></div>
</div>
</div>
</div>
<p>Đặt toàn bộ hàng hoặc cột bằng cách sử dụng một mảng boolean một chiều cũng dễ dàng:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_bool_copy</span><span class="p">[</span><span class="n">names</span> <span class="o">!=</span> <span class="s2">&quot;Joe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span> <span class="c1"># Sử dụng data_bool_copy đã được sửa đổi</span>
<span class="n">data_bool_copy</span>
</pre></div>
</div>
</div>
</div>
<p>Như bạn sẽ thấy sau, các loại hoạt động này trên dữ liệu hai chiều cũng tiện lợi để thực hiện với pandas.</p>
</section>
<section id="chi-muc-hoa-nang-cao-fancy-indexing">
<h3>Chỉ mục hóa nâng cao (Fancy Indexing)<a class="headerlink" href="#chi-muc-hoa-nang-cao-fancy-indexing" title="Link to this heading">#</a></h3>
<p><em>Chỉ mục hóa nâng cao</em> (Fancy indexing) là một thuật ngữ được NumPy sử dụng để mô tả việc chỉ mục hóa bằng cách sử dụng các mảng số nguyên. Giả sử chúng ta có một mảng 8 × 4:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_fancy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">arr_fancy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
<span class="n">arr_fancy</span>
</pre></div>
</div>
</div>
</div>
<p>Để chọn một tập con các hàng theo một thứ tự cụ thể, bạn có thể chỉ cần truyền một danh sách hoặc <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> các số nguyên chỉ định thứ tự mong muốn:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_fancy</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>Hy vọng rằng điều này được đặt tên một cách khéo léo. Việc sử dụng các chỉ mục âm sẽ chọn các hàng từ cuối:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_fancy</span><span class="p">[[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>Việc truyền nhiều mảng chỉ mục sẽ làm một điều hơi khác; nó chọn một mảng một chiều các phần tử tương ứng với mỗi tuple chỉ mục:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_fancy_reshape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">arr_fancy_reshape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_fancy_reshape</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>Ở đây các phần tử <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">(5,</span> <span class="pre">3)</span></code>, <code class="docutils literal notranslate"><span class="pre">(7,</span> <span class="pre">1)</span></code>, và <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2)</span></code> đã được chọn. Kết quả của chỉ mục hóa nâng cao luôn là một bản sao một chiều của dữ liệu, bất kể số chiều của mảng (so với cắt lát).</p>
<p>Đây là một ví dụ khác về cách chọn một tập hợp con hình chữ nhật của các hàng và cột:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_fancy_reshape</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">]][:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>Hãy nhớ rằng chỉ mục hóa nâng cao, không giống như cắt lát, luôn sao chép dữ liệu vào một mảng mới. Nếu bạn cần một khung nhìn, bạn sẽ cần sử dụng các phương pháp khác, chẳng hạn như một tập hợp các lát cắt.</p>
<p>Hành vi này có vẻ hơi khác thường đối với một số người dùng, nhưng nó cung cấp một cách mạnh mẽ và linh hoạt để định hình lại dữ liệu mảng.</p>
<p>Việc gán với chỉ mục hóa nâng cao hoạt động như mong đợi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_fancy_reshape_copy</span> <span class="o">=</span> <span class="n">arr_fancy_reshape</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">arr_fancy_reshape_copy</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">arr_fancy_reshape_copy</span>
</pre></div>
</div>
</div>
</div>
<p>Như một ví dụ cuối cùng, giả sử chúng ta muốn chọn các hàng theo một thứ tự cụ thể, và sau đó sắp xếp lại các cột. Một cách để làm điều này là:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_fancy_ix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">arr_fancy_ix</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span> <span class="c1"># Chọn các hàng</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_fancy_ix</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">]][:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span> <span class="c1"># Chọn các hàng và sau đó sắp xếp lại các cột</span>
</pre></div>
</div>
</div>
</div>
<p>Để làm điều này theo một cách ngắn gọn hơn, bạn có thể sử dụng <code class="docutils literal notranslate"><span class="pre">np.ix_</span></code>. Hàm này chuyển đổi hai mảng số nguyên một chiều thành một bộ chỉ mục chọn một vùng hình vuông từ một mảng:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_fancy_ix</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])]</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">np.ix_</span></code> trả về một đối tượng có thể được sử dụng để chỉ mục hóa mảng. Trong trường hợp này, nó tạo ra một đối tượng chỉ mục chọn các hàng 1, 5, 7, 2 và các cột 0, 3, 1, 2. Điều này tương đương với việc chọn các hàng với <code class="docutils literal notranslate"><span class="pre">arr[[1,</span> <span class="pre">5,</span> <span class="pre">7,</span> <span class="pre">2],</span> <span class="pre">:]</span></code> và sau đó chọn các cột với <code class="docutils literal notranslate"><span class="pre">[:,</span> <span class="pre">[0,</span> <span class="pre">3,</span> <span class="pre">1,</span> <span class="pre">2]]</span></code> trên kết quả.</p>
</section>
<section id="chuyen-vi-mang-va-hoan-doi-truc-transposing-arrays-and-swapping-axes">
<h3>Chuyển vị mảng và Hoán đổi trục (Transposing Arrays and Swapping Axes)<a class="headerlink" href="#chuyen-vi-mang-va-hoan-doi-truc-transposing-arrays-and-swapping-axes" title="Link to this heading">#</a></h3>
<p>Chuyển vị là một dạng đặc biệt của việc định hình lại (reshaping) mà cũng trả về một khung nhìn (view) của dữ liệu cơ bản mà không sao chép bất cứ thứ gì. Các mảng có thuộc tính <code class="docutils literal notranslate"><span class="pre">T</span></code> và phương thức <code class="docutils literal notranslate"><span class="pre">transpose</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">arr_T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_T</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<p>Khi thực hiện các phép toán đại số ma trận, bạn có thể làm điều này rất thường xuyên—ví dụ, khi tính toán tích trong (inner product) của ma trận bằng <code class="docutils literal notranslate"><span class="pre">np.dot</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_dot_T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">arr_dot_T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">arr_dot_T</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">arr_dot_T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Phương thức <code class="docutils literal notranslate"><span class="pre">transpose</span></code> có thể nhận một tuple các số trục để hoán vị các trục (đối với các mục đích nâng cao hơn):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_transpose_axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">arr_transpose_axes</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_transpose_axes</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Ở đây, các trục đã được sắp xếp lại với trục thứ hai là trục đầu tiên, trục đầu tiên là trục thứ hai và trục cuối cùng không thay đổi.</p>
<p>Chỉ mục hóa đơn giản bằng <code class="docutils literal notranslate"><span class="pre">arr[i]</span></code> sẽ chọn dữ liệu dọc theo trục 0. Để chọn dữ liệu dọc theo các trục khác, bạn có thể cần phải thực hiện một số định hình lại hoặc chuyển vị. Các mảng <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> có một phương thức <code class="docutils literal notranslate"><span class="pre">swapaxes</span></code> nhận một cặp số trục và chuyển đổi các trục được chỉ định để sắp xếp lại dữ liệu:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_transpose_axes</span> <span class="c1"># arr_transpose_axes từ ô trên</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_transpose_axes</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">swapaxes</span></code> tương tự cũng trả về một khung nhìn trên dữ liệu mà không tạo bản sao.</p>
</section>
</section>
<section id="ham-pho-quat-cac-ham-mang-tinh-toan-theo-tung-phan-tu-nhanh-chong">
<h2>4.2 Hàm phổ quát: Các hàm mảng tính toán theo từng phần tử nhanh chóng<a class="headerlink" href="#ham-pho-quat-cac-ham-mang-tinh-toan-theo-tung-phan-tu-nhanh-chong" title="Link to this heading">#</a></h2>
<p>Một hàm phổ quát, hay <em>ufunc</em>, là một hàm thực hiện các phép toán theo từng phần tử (element-wise) trên dữ liệu trong <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>. Bạn có thể coi chúng là các <em>wrapper</em> (trình bao bọc) được vector hóa nhanh chóng cho các hàm đơn giản nhận một hoặc nhiều giá trị vô hướng và tạo ra một hoặc nhiều kết quả vô hướng.</p>
<p>Nhiều ufunc rất đơn giản, thực hiện theo từng phần tử, như <code class="docutils literal notranslate"><span class="pre">np.sqrt</span></code> hoặc <code class="docutils literal notranslate"><span class="pre">np.exp</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_ufunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">arr_ufunc</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">arr_ufunc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">arr_ufunc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Những hàm này được gọi là <em>ufunc đơn phân</em> (unary ufuncs). Những hàm khác, chẳng hạn như <code class="docutils literal notranslate"><span class="pre">np.add</span></code> hoặc <code class="docutils literal notranslate"><span class="pre">np.maximum</span></code>, nhận hai mảng (do đó, <em>ufunc nhị phân</em> (binary ufuncs)) và trả về một mảng duy nhất làm kết quả:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_ufunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">y_ufunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">x_ufunc</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_ufunc</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">x_ufunc</span><span class="p">,</span> <span class="n">y_ufunc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Ở đây, <code class="docutils literal notranslate"><span class="pre">np.maximum</span></code> đã tính toán giá trị lớn nhất theo từng phần tử trong <code class="docutils literal notranslate"><span class="pre">x_ufunc</span></code> và <code class="docutils literal notranslate"><span class="pre">y_ufunc</span></code>.</p>
<p>Trong khi không phổ biến, một ufunc có thể trả về nhiều mảng. <code class="docutils literal notranslate"><span class="pre">np.modf</span></code> là một ví dụ: một ufunc đơn phân trả về phần phân số và phần nguyên của một mảng dấu phẩy động:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_modf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>
<span class="n">arr_modf</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">remainder</span><span class="p">,</span> <span class="n">whole_part</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">modf</span><span class="p">(</span><span class="n">arr_modf</span><span class="p">)</span>
<span class="n">remainder</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">whole_part</span>
</pre></div>
</div>
</div>
</div>
<p>Ufunc chấp nhận một đối số <code class="docutils literal notranslate"><span class="pre">out</span></code> tùy chọn cho phép chúng hoạt động tại chỗ trên các mảng:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_modf</span> <span class="c1"># arr_modf từ ô trước</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">arr_modf</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">arr_modf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out_arr</span><span class="p">)</span> <span class="c1"># out_arr += arr + 1, không tạo mảng mới</span>
<span class="n">out_arr</span>
</pre></div>
</div>
</div>
</div>
<p>Bảng 4.3 và 4.4 liệt kê nhiều ufunc đơn phân và nhị phân của NumPy. Một số trong số này sẽ được sử dụng trong các ví dụ trong suốt cuốn sách.</p>
<p><strong>Bảng 4.3: Một số ufunc đơn phân</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Hàm</p></th>
<th class="head"><p>Mô tả</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">abs</span></code>, <code class="docutils literal notranslate"><span class="pre">fabs</span></code></p></td>
<td><p>Tính giá trị tuyệt đối theo từng phần tử cho số nguyên, số thực dấu phẩy động hoặc số phức. Sử dụng <code class="docutils literal notranslate"><span class="pre">fabs</span></code> cho dữ liệu số thực dấu phẩy động không phức (trả về một mảng số thực dấu phẩy động).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sqrt</span></code></p></td>
<td><p>Tính căn bậc hai theo từng phần tử. Tương đương với <code class="docutils literal notranslate"><span class="pre">arr</span> <span class="pre">**</span> <span class="pre">0.5</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">square</span></code></p></td>
<td><p>Tính bình phương theo từng phần tử. Tương đương với <code class="docutils literal notranslate"><span class="pre">arr</span> <span class="pre">**</span> <span class="pre">2</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exp</span></code></p></td>
<td><p>Tính lũy thừa e^x theo từng phần tử.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">log</span></code>, <code class="docutils literal notranslate"><span class="pre">log10</span></code>, <code class="docutils literal notranslate"><span class="pre">log2</span></code>, <code class="docutils literal notranslate"><span class="pre">log1p</span></code></p></td>
<td><p>Logarit tự nhiên (cơ số e), logarit cơ số 10, logarit cơ số 2, và log(1 + x) tương ứng.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sign</span></code></p></td>
<td><p>Tính dấu của mỗi phần tử: 1 (dương), 0 (zero), hoặc –1 (âm).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ceil</span></code></p></td>
<td><p>Tính trần theo từng phần tử (giá trị nguyên nhỏ nhất lớn hơn hoặc bằng mỗi phần tử).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">floor</span></code></p></td>
<td><p>Tính sàn theo từng phần tử (giá trị nguyên lớn nhất nhỏ hơn hoặc bằng mỗi phần tử).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rint</span></code></p></td>
<td><p>Làm tròn các phần tử đến số nguyên gần nhất, giữ nguyên <code class="docutils literal notranslate"><span class="pre">dtype</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">modf</span></code></p></td>
<td><p>Trả về phần phân số và phần nguyên của mảng dưới dạng các mảng riêng biệt.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">isnan</span></code></p></td>
<td><p>Trả về một mảng boolean cho biết mỗi giá trị có phải là <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (Not a Number) hay không.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">isfinite</span></code>, <code class="docutils literal notranslate"><span class="pre">isinf</span></code></p></td>
<td><p>Trả về các mảng boolean cho biết mỗi phần tử có hữu hạn (không-<code class="docutils literal notranslate"><span class="pre">inf</span></code>, không-<code class="docutils literal notranslate"><span class="pre">NaN</span></code>) hoặc vô hạn tương ứng.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cos</span></code>, <code class="docutils literal notranslate"><span class="pre">cosh</span></code>, <code class="docutils literal notranslate"><span class="pre">sin</span></code>, <code class="docutils literal notranslate"><span class="pre">sinh</span></code>, <code class="docutils literal notranslate"><span class="pre">tan</span></code>, <code class="docutils literal notranslate"><span class="pre">tanh</span></code></p></td>
<td><p>Các hàm lượng giác thông thường và các hàm hypebolic tương ứng.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">arccos</span></code>, <code class="docutils literal notranslate"><span class="pre">arccosh</span></code>, <code class="docutils literal notranslate"><span class="pre">arcsin</span></code>, <code class="docutils literal notranslate"><span class="pre">arcsinh</span></code>, <code class="docutils literal notranslate"><span class="pre">arctan</span></code>, <code class="docutils literal notranslate"><span class="pre">arctanh</span></code></p></td>
<td><p>Các hàm lượng giác nghịch đảo.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">logical_not</span></code></p></td>
<td><p>Tính giá trị chân lý của <code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">x</span></code> theo từng phần tử. Tương đương với <code class="docutils literal notranslate"><span class="pre">~arr</span></code>.</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Bảng 4.4: Một số ufunc nhị phân</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Hàm</p></th>
<th class="head"><p>Mô tả</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">add</span></code></p></td>
<td><p>Cộng các phần tử tương ứng trong các mảng.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">subtract</span></code></p></td>
<td><p>Trừ các phần tử trong mảng thứ hai khỏi mảng thứ nhất, theo từng phần tử.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">multiply</span></code></p></td>
<td><p>Nhân các phần tử của mảng, theo từng phần tử.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">divide</span></code>, <code class="docutils literal notranslate"><span class="pre">floor_divide</span></code></p></td>
<td><p>Chia hoặc chia lấy phần nguyên (làm tròn xuống).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">power</span></code></p></td>
<td><p>Nâng các phần tử trong mảng thứ nhất lên lũy thừa của các phần tử tương ứng trong mảng thứ hai, theo từng phần tử.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">maximum</span></code>, <code class="docutils literal notranslate"><span class="pre">fmax</span></code></p></td>
<td><p>Tối đa theo từng phần tử. <code class="docutils literal notranslate"><span class="pre">fmax</span></code> bỏ qua <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">minimum</span></code>, <code class="docutils literal notranslate"><span class="pre">fmin</span></code></p></td>
<td><p>Tối thiểu theo từng phần tử. <code class="docutils literal notranslate"><span class="pre">fmin</span></code> bỏ qua <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mod</span></code></p></td>
<td><p>Phần dư theo từng phần tử (tương đương với toán tử <code class="docutils literal notranslate"><span class="pre">%</span></code> của Python).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">copysign</span></code></p></td>
<td><p>Sao chép dấu của các giá trị trong mảng thứ hai vào các giá trị trong mảng thứ nhất, theo từng phần tử.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">greater</span></code>, <code class="docutils literal notranslate"><span class="pre">greater_equal</span></code>, <code class="docutils literal notranslate"><span class="pre">less</span></code>, <code class="docutils literal notranslate"><span class="pre">less_equal</span></code>, <code class="docutils literal notranslate"><span class="pre">equal</span></code>, <code class="docutils literal notranslate"><span class="pre">not_equal</span></code></p></td>
<td><p>Thực hiện các phép so sánh theo từng phần tử, tạo ra một mảng boolean. Tương đương với các toán tử infix như <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> , <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code> , <code class="docutils literal notranslate"><span class="pre">==</span></code> , v.v.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">logical_and</span></code>, <code class="docutils literal notranslate"><span class="pre">logical_or</span></code>, <code class="docutils literal notranslate"><span class="pre">logical_xor</span></code></p></td>
<td><p>Thực hiện các phép toán logic AND, OR, và XOR theo từng phần tử. Tương đương với các toán tử infix <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>, `</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="xu-ly-du-lieu-dua-tren-mang">
<h2>4.3 Xử lý dữ liệu dựa trên mảng<a class="headerlink" href="#xu-ly-du-lieu-dua-tren-mang" title="Link to this heading">#</a></h2>
<p>Sử dụng mảng NumPy cho phép bạn thể hiện nhiều loại tác vụ xử lý dữ liệu dưới dạng các biểu thức mảng súc tích, nếu không thì sẽ yêu cầu viết vòng lặp. Việc thực hành viết các thuật toán dưới dạng các phép toán mảng thay vì các vòng lặp trên các phần tử riêng lẻ được gọi là <em>vector hóa</em>. Nói chung, các phép toán mảng được vector hóa thường nhanh hơn nhiều so với các phép toán tương đương trong Python thuần túy. Sau đây là một ví dụ đơn giản trong đó chúng ta muốn đánh giá hàm <code class="docutils literal notranslate"><span class="pre">sqrt(x^2</span> <span class="pre">+</span> <span class="pre">y^2)</span></code> trên một lưới các giá trị đều nhau. Hàm <code class="docutils literal notranslate"><span class="pre">np.meshgrid</span></code> nhận hai mảng 1D và tạo ra hai mảng 2D tương ứng với tất cả các cặp <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> trong hai mảng đó:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span> <span class="c1"># 1000 điểm cách đều nhau</span>
<span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span>
<span class="n">ys</span>
</pre></div>
</div>
</div>
</div>
<p>Bây giờ, việc đánh giá hàm chỉ đơn giản là vấn đề viết cùng một biểu thức như bạn sẽ viết với hai điểm:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xs</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">ys</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">z</span>
</pre></div>
</div>
</div>
</div>
<p>Là một bản xem trước nhanh, tôi đã vẽ biểu đồ kết quả của việc đánh giá hàm này với Matplotlib:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Image plot of $\sqrt{x^2 + y^2}$ for a grid of values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># Sử dụng plt.show() để hiển thị trong notebook</span>
</pre></div>
</div>
</div>
</div>
<p>Hình 4.3 cho thấy hình ảnh kết quả.</p>
<p><strong>Hình 4.3: Biểu đồ hình ảnh của sqrt(x^2 + y^2)</strong></p>
<p>(Hình ảnh hiển thị một biểu đồ hình ảnh 2D của hàm z)</p>
<section id="the-hien-logic-co-dieu-kien-duoi-dang-cac-phep-toan-mang">
<h3>Thể hiện logic có điều kiện dưới dạng các phép toán mảng<a class="headerlink" href="#the-hien-logic-co-dieu-kien-duoi-dang-cac-phep-toan-mang" title="Link to this heading">#</a></h3>
<p>Hàm <code class="docutils literal notranslate"><span class="pre">numpy.where</span></code> là một phiên bản vector hóa của biểu thức tam phân (ternary expression) <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">if</span> <span class="pre">condition</span> <span class="pre">else</span> <span class="pre">y</span></code>. Giả sử chúng ta có một mảng boolean và hai mảng các giá trị:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xarr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="n">yarr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">])</span>
<span class="n">cond_where</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Giả sử chúng ta muốn lấy một giá trị từ <code class="docutils literal notranslate"><span class="pre">xarr</span></code> bất cứ khi nào giá trị tương ứng trong <code class="docutils literal notranslate"><span class="pre">cond_where</span></code> là <code class="docutils literal notranslate"><span class="pre">True</span></code> và nếu không thì lấy giá trị từ <code class="docutils literal notranslate"><span class="pre">yarr</span></code>. Một danh sách hiểu (list comprehension) để làm điều này có thể trông như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_lc</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span> <span class="k">if</span> <span class="n">c</span> <span class="k">else</span> <span class="n">y</span><span class="p">)</span>
             <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xarr</span><span class="p">,</span> <span class="n">yarr</span><span class="p">,</span> <span class="n">cond_where</span><span class="p">)]</span>
<span class="n">result_lc</span>
</pre></div>
</div>
</div>
</div>
<p>Điều này có nhiều vấn đề. Thứ nhất, nó sẽ không nhanh đối với các mảng lớn (vì tất cả công việc được thực hiện trong Python thuần túy được diễn giải). Thứ hai, nó sẽ không hoạt động với các mảng đa chiều. Với <code class="docutils literal notranslate"><span class="pre">np.where</span></code>, bạn có thể viết điều này rất ngắn gọn:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_where</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cond_where</span><span class="p">,</span> <span class="n">xarr</span><span class="p">,</span> <span class="n">yarr</span><span class="p">)</span>
<span class="n">result_where</span>
</pre></div>
</div>
</div>
</div>
<p>Các đối số thứ hai và thứ ba cho <code class="docutils literal notranslate"><span class="pre">np.where</span></code> không cần phải là mảng; một hoặc cả hai có thể là các đại lượng vô hướng. Một công dụng điển hình của <code class="docutils literal notranslate"><span class="pre">where</span></code> trong phân tích dữ liệu là tạo ra một mảng mới các giá trị dựa trên một mảng khác. Giả sử bạn có một ma trận dữ liệu được tạo ngẫu nhiên và bạn muốn thay thế tất cả các giá trị dương bằng 2 và tất cả các giá trị âm bằng –2. Điều này rất dễ thực hiện với <code class="docutils literal notranslate"><span class="pre">np.where</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_rand_where</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">arr_rand_where</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_rand_where</span> <span class="o">&gt;</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">arr_rand_where</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Bạn có thể kết hợp các đại lượng vô hướng và mảng khi sử dụng <code class="docutils literal notranslate"><span class="pre">np.where</span></code>. Ví dụ, tôi có thể đặt tất cả các giá trị dương trong <code class="docutils literal notranslate"><span class="pre">arr_rand_where</span></code> thành 2 như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">arr_rand_where</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">arr_rand_where</span><span class="p">)</span> <span class="c1"># đặt chỉ các giá trị dương thành 2</span>
</pre></div>
</div>
</div>
</div>
<p>Các mảng được truyền cho đối số thứ hai và thứ ba của <code class="docutils literal notranslate"><span class="pre">where</span></code> không nhất thiết phải có cùng <code class="docutils literal notranslate"><span class="pre">shape</span></code>, nhưng chúng phải có thể lan truyền (broadcastable) đến một <code class="docutils literal notranslate"><span class="pre">shape</span></code> chung. Chúng ta sẽ thảo luận chi tiết hơn về các quy tắc lan truyền trong Phụ lục A. Mặc dù <code class="docutils literal notranslate"><span class="pre">where</span></code> không bị giới hạn ở việc sử dụng trên các mảng boolean, nhưng nó đặc biệt hữu ích cho việc đó.</p>
</section>
<section id="cac-phuong-thuc-thong-ke-toan-hoc">
<h3>Các phương thức thống kê toán học<a class="headerlink" href="#cac-phuong-thuc-thong-ke-toan-hoc" title="Link to this heading">#</a></h3>
<p>Một tập hợp các hàm toán học tính toán các thống kê về toàn bộ một mảng hoặc về dữ liệu dọc theo một trục là các phép toán mảng có thể truy cập được dưới dạng các phương thức của lớp mảng. Bạn có thể lấy các tổng hợp (thường được gọi là <em>réductions</em>) như <code class="docutils literal notranslate"><span class="pre">sum</span></code>, <code class="docutils literal notranslate"><span class="pre">mean</span></code>, và <code class="docutils literal notranslate"><span class="pre">std</span></code> (độ lệch chuẩn) bằng cách gọi phương thức của instance mảng hoặc sử dụng hàm NumPy cấp cao nhất. Khi bạn sử dụng hàm cấp cao nhất, bạn thường phải truyền mảng mà bạn muốn tính toán thống kê làm đối số đầu tiên.</p>
<p>Ở đây tôi tạo một số dữ liệu được phân phối chuẩn ngẫu nhiên và tính toán một số thống kê tổng hợp:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_stats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">arr_stats</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_stats</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">arr_stats</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_stats</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Các hàm như <code class="docutils literal notranslate"><span class="pre">mean</span></code> và <code class="docutils literal notranslate"><span class="pre">sum</span></code> nhận một đối số <code class="docutils literal notranslate"><span class="pre">axis</span></code> tùy chọn để tính toán thống kê trên trục được chỉ định, dẫn đến một mảng có ít hơn một chiều:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_stats</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_stats</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Ở đây, <code class="docutils literal notranslate"><span class="pre">arr_stats.mean(axis=1)</span></code> có nghĩa là “tính trung bình trên các cột” và <code class="docutils literal notranslate"><span class="pre">arr_stats.sum(axis=0)</span></code> có nghĩa là “tính tổng trên các hàng”. Các phương thức khác như <code class="docutils literal notranslate"><span class="pre">cumsum</span></code> và <code class="docutils literal notranslate"><span class="pre">cumprod</span></code> không tổng hợp, thay vào đó tạo ra một mảng các kết quả trung gian:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="n">arr_cumsum</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Trong các mảng đa chiều, các hàm tích lũy như <code class="docutils literal notranslate"><span class="pre">cumsum</span></code> trả về một mảng có cùng kích thước nhưng với các tổng hoặc tích một phần được tính toán dọc theo trục được chỉ định theo các phần tử “thấp hơn” trong lát cắt 1D:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_cumsum_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
<span class="n">arr_cumsum_2d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_cumsum_2d</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_cumsum_2d</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Bảng 4.5 cung cấp một danh sách các phương thức tổng hợp và thống kê mảng có sẵn. Chúng ta sẽ xem xét nhiều phương thức này chi tiết hơn trong các chương sau.</p>
<p><strong>Bảng 4.5: Các phương thức thống kê mảng cơ bản</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Phương thức</p></th>
<th class="head"><p>Mô tả</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sum</span></code></p></td>
<td><p>Tổng của tất cả các phần tử trong mảng hoặc dọc theo một trục. Các mảng có kích thước zero có tổng là 0.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mean</span></code></p></td>
<td><p>Trung bình số học. Các mảng có kích thước zero có <code class="docutils literal notranslate"><span class="pre">NaN</span></code> làm trung bình.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">std</span></code>, <code class="docutils literal notranslate"><span class="pre">var</span></code></p></td>
<td><p>Độ lệch chuẩn và phương sai, tương ứng, với khả năng điều chỉnh bậc tự do của mẫu số.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code></p></td>
<td><p>Giá trị tối thiểu và tối đa.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">argmin</span></code>, <code class="docutils literal notranslate"><span class="pre">argmax</span></code></p></td>
<td><p>Chỉ mục của các phần tử tối thiểu và tối đa, tương ứng.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cumsum</span></code></p></td>
<td><p>Tổng tích lũy của các phần tử bắt đầu từ 0.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cumprod</span></code></p></td>
<td><p>Tích tích lũy của các phần tử bắt đầu từ 1.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="cac-phuong-thuc-cho-mang-boolean">
<h3>Các phương thức cho mảng Boolean<a class="headerlink" href="#cac-phuong-thuc-cho-mang-boolean" title="Link to this heading">#</a></h3>
<p>Các giá trị boolean được ép kiểu thành 1 (<code class="docutils literal notranslate"><span class="pre">True</span></code>) và 0 (<code class="docutils literal notranslate"><span class="pre">False</span></code>) trong các phương thức trước đó. Do đó, <code class="docutils literal notranslate"><span class="pre">sum</span></code> thường được sử dụng như một phương tiện để đếm các giá trị <code class="docutils literal notranslate"><span class="pre">True</span></code> trong một mảng boolean:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_bool_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="p">(</span><span class="n">arr_bool_sum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># Số lượng các giá trị dương</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">arr_bool_sum</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># Số lượng các giá trị không dương</span>
</pre></div>
</div>
</div>
</div>
<p>Có hai phương thức bổ sung, <code class="docutils literal notranslate"><span class="pre">any</span></code> và <code class="docutils literal notranslate"><span class="pre">all</span></code>, đặc biệt hữu ích cho các mảng boolean. <code class="docutils literal notranslate"><span class="pre">any</span></code> kiểm tra xem có ít nhất một giá trị <code class="docutils literal notranslate"><span class="pre">True</span></code> trong mảng hay không, trong khi <code class="docutils literal notranslate"><span class="pre">all</span></code> kiểm tra xem mọi giá trị có phải là <code class="docutils literal notranslate"><span class="pre">True</span></code> hay không:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bools</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
<span class="n">bools</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bools</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Các phương thức này cũng hoạt động với các mảng không phải boolean, trong đó các phần tử khác không được coi là <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</section>
<section id="sap-xep-sorting">
<h3>Sắp xếp (Sorting)<a class="headerlink" href="#sap-xep-sorting" title="Link to this heading">#</a></h3>
<p>Giống như kiểu danh sách tích hợp sẵn của Python, các mảng NumPy có thể được sắp xếp tại chỗ (in-place) bằng phương thức <code class="docutils literal notranslate"><span class="pre">sort</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_sort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">arr_sort</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_sort</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">arr_sort</span>
</pre></div>
</div>
</div>
</div>
<p>Bạn có thể sắp xếp mỗi phần 1D của một mảng đa chiều tại chỗ dọc theo một trục bằng cách truyền số trục cho <code class="docutils literal notranslate"><span class="pre">sort</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_sort_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">arr_sort_2d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_sort_2d_copy</span> <span class="o">=</span> <span class="n">arr_sort_2d</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">arr_sort_2d_copy</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Sắp xếp các cột</span>
<span class="n">arr_sort_2d_copy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_sort_2d_copy_2</span> <span class="o">=</span> <span class="n">arr_sort_2d</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">arr_sort_2d_copy_2</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Sắp xếp các hàng</span>
<span class="n">arr_sort_2d_copy_2</span>
</pre></div>
</div>
</div>
</div>
<p>Hàm cấp cao nhất <code class="docutils literal notranslate"><span class="pre">np.sort</span></code> trả về một bản sao đã sắp xếp của một mảng thay vì sửa đổi mảng tại chỗ. Một cách nhanh chóng và hiệu quả để tính toán các phân vị (quantiles) của một mảng là sắp xếp nó và chọn giá trị tại một hạng cụ thể. Ví dụ:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">large_arr_sort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">large_arr_sort</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">large_arr_sort</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">large_arr_sort</span><span class="p">))]</span> <span class="c1"># 5% quantile</span>
</pre></div>
</div>
</div>
</div>
<p>Để biết thêm chi tiết về việc sử dụng các tính năng sắp xếp của NumPy, và các thuật toán nâng cao hơn như sắp xếp gián tiếp (indirect sorts), xem Phụ lục A. Một số hàm khác của NumPy liên quan đến sắp xếp, như <code class="docutils literal notranslate"><span class="pre">lexsort</span></code>, không được đề cập ở đây vì chúng ít được sử dụng trong phân tích dữ liệu hàng ngày.</p>
</section>
<section id="cac-phep-toan-tap-hop-set-operations-cho-mang-1d">
<h3>Các phép toán tập hợp (Set Operations) cho Mảng 1D<a class="headerlink" href="#cac-phep-toan-tap-hop-set-operations-cho-mang-1d" title="Link to this heading">#</a></h3>
<p>NumPy có một số phép toán tập hợp cơ bản cho các mảng 1D. Một hàm thường được sử dụng là <code class="docutils literal notranslate"><span class="pre">np.unique</span></code>, trả về các phần tử duy nhất đã được sắp xếp trong một mảng:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">names_set</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Joe&quot;</span><span class="p">,</span> <span class="s2">&quot;Will&quot;</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Will&quot;</span><span class="p">,</span> <span class="s2">&quot;Joe&quot;</span><span class="p">,</span> <span class="s2">&quot;Joe&quot;</span><span class="p">])</span>
<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">names_set</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ints_set</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">ints_set</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Hãy đối chiếu <code class="docutils literal notranslate"><span class="pre">np.unique</span></code> với Python thuần túy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names_set</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Một hàm khác, <code class="docutils literal notranslate"><span class="pre">np.in1d</span></code>, kiểm tra tư cách thành viên của các giá trị trong một mảng trong một mảng khác, trả về một mảng boolean:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">values_set</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">np</span><span class="o">.</span><span class="n">in1d</span><span class="p">(</span><span class="n">values_set</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Xem Bảng 4.6 để biết danh sách các hàm tập hợp của NumPy cho các mảng 1D.</p>
<p><strong>Bảng 4.6: Các phép toán tập hợp mảng</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Phương thức</p></th>
<th class="head"><p>Mô tả</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">unique(x)</span></code></p></td>
<td><p>Tính toán các phần tử duy nhất đã được sắp xếp trong <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">intersect1d(x,</span> <span class="pre">y)</span></code></p></td>
<td><p>Tính toán các phần tử chung đã được sắp xếp trong <code class="docutils literal notranslate"><span class="pre">x</span></code> và <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">union1d(x,</span> <span class="pre">y)</span></code></p></td>
<td><p>Tính toán hợp của các phần tử đã được sắp xếp.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">in1d(x,</span> <span class="pre">y)</span></code></p></td>
<td><p>Tính toán một mảng boolean cho biết liệu mỗi phần tử của <code class="docutils literal notranslate"><span class="pre">x</span></code> có chứa trong <code class="docutils literal notranslate"><span class="pre">y</span></code> hay không.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">setdiff1d(x,</span> <span class="pre">y)</span></code></p></td>
<td><p>Hiệu tập hợp; các phần tử trong <code class="docutils literal notranslate"><span class="pre">x</span></code> không có trong <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">setxor1d(x,</span> <span class="pre">y)</span></code></p></td>
<td><p>Hiệu đối xứng tập hợp; các phần tử nằm trong một trong các mảng nhưng không nằm trong cả hai.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="nhap-va-xuat-file-voi-mang">
<h2>4.4 Nhập và Xuất file với Mảng<a class="headerlink" href="#nhap-va-xuat-file-voi-mang" title="Link to this heading">#</a></h2>
<p>NumPy có thể lưu và tải dữ liệu vào và từ đĩa ở định dạng văn bản hoặc nhị phân. Trong các phần sau, tôi sẽ thảo luận về các công cụ tích hợp sẵn của NumPy để đọc và ghi các mảng, nhưng hãy nhớ rằng pandas cung cấp nhiều hàm tuyệt vời để đọc các tệp văn bản hoặc dạng bảng vào các đối tượng <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>; những hàm đó sẽ được đề cập chi tiết hơn trong Chương 6.</p>
<p>Các mảng được lưu vào đĩa ở định dạng nhị phân bằng <code class="docutils literal notranslate"><span class="pre">np.save</span></code> và được tải bằng <code class="docutils literal notranslate"><span class="pre">np.load</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_io</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;some_array&quot;</span><span class="p">,</span> <span class="n">arr_io</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nếu tệp chưa có phần mở rộng <code class="docutils literal notranslate"><span class="pre">.npy</span></code>, nó sẽ được tự động thêm vào. Sau đó, mảng trên đĩa có thể được tải bằng <code class="docutils literal notranslate"><span class="pre">np.load</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;some_array.npy&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Bạn lưu nhiều mảng trong một kho lưu trữ zip không nén bằng <code class="docutils literal notranslate"><span class="pre">np.savez</span></code> và truyền các mảng dưới dạng đối số từ khóa:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span><span class="s2">&quot;array_archive.npz&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">arr_io</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">arr_io</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Khi tải một tệp <code class="docutils literal notranslate"><span class="pre">.npz</span></code>, bạn nhận được một đối tượng giống từ điển (dictionary-like object) tải các mảng riêng lẻ một cách lười biếng (lazily):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;array_archive.npz&quot;</span><span class="p">)</span>
<span class="n">arch</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Nếu dữ liệu của bạn nén tốt, bạn có thể muốn sử dụng <code class="docutils literal notranslate"><span class="pre">numpy.savez_compressed</span></code> thay thế:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">savez_compressed</span><span class="p">(</span><span class="s2">&quot;arrays_compressed.npz&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">arr_io</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">arr_io</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Như một lưu ý phụ, nếu bạn thấy mình làm việc với dữ liệu đã được lưu trữ trong các định dạng tệp cũ của Fortran, bạn có thể muốn xem xét <code class="docutils literal notranslate"><span class="pre">scipy.io</span></code>.</p>
<section id="luu-va-tai-tep-van-ban">
<h3>Lưu và tải tệp văn bản<a class="headerlink" href="#luu-va-tai-tep-van-ban" title="Link to this heading">#</a></h3>
<p>Việc tải dữ liệu văn bản từ các tệp có thể được thực hiện bằng các hàm như <code class="docutils literal notranslate"><span class="pre">np.loadtxt</span></code> hoặc hàm <code class="docutils literal notranslate"><span class="pre">np.genfromtxt</span></code> tổng quát hơn. Các hàm này có nhiều tùy chọn, nhưng cách sử dụng điển hình là tải các tệp văn bản được phân tách bằng dấu phân cách (như CSV). Hãy xem xét một tệp CSV trông như thế này:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">foo</span>
<span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="n">bar</span>
<span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="n">baz</span>
</pre></div>
</div>
<p>Tệp này có thể được tải vào một mảng NumPy hai chiều như sau:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Để chạy ví dụ này, bạn cần tạo một file tên là array_ex.txt</span>
<span class="c1"># với nội dung như sau:</span>
<span class="c1"># 1,2,3,4, # Bỏ qua foo vì loadtxt mặc định chỉ đọc số</span>
<span class="c1"># 5,6,7,8,</span>
<span class="c1"># 9,10,11,12</span>

<span class="c1"># with open(&quot;array_ex.txt&quot;, &quot;w&quot;) as f:</span>
<span class="c1">#     f.write(&quot;1,2,3,4\n&quot;)</span>
<span class="c1">#     f.write(&quot;5,6,7,8\n&quot;)</span>
<span class="c1">#     f.write(&quot;9,10,11,12\n&quot;)</span>

<span class="c1"># arr_loadtxt = np.loadtxt(&quot;array_ex.txt&quot;, delimiter=&quot;,&quot;)</span>
<span class="c1"># arr_loadtxt</span>

<span class="c1"># np.savetxt(&quot;my_array_saved.csv&quot;, arr_loadtxt, delimiter=&quot;,&quot;)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">np.savetxt</span></code> thực hiện thao tác ngược lại: ghi một mảng vào một tệp văn bản được phân tách bằng dấu phân cách. Hàm <code class="docutils literal notranslate"><span class="pre">np.genfromtxt</span></code> tương tự như <code class="docutils literal notranslate"><span class="pre">np.loadtxt</span></code> nhưng hướng đến các mảng có cấu trúc và xử lý dữ liệu bị thiếu. Chúng ta sẽ không sử dụng các hàm này nhiều trong cuốn sách này, vì các công cụ của pandas để đọc các tệp văn bản (như <code class="docutils literal notranslate"><span class="pre">pandas.read_csv</span></code>) thường thuận tiện hơn. Đối với dữ liệu rất lớn, những hàm này có thể không đủ nhanh, vì vậy bạn có thể cần phải phát triển một trình phân tích tệp tùy chỉnh hoặc sử dụng một công cụ khác.</p>
</section>
</section>
<section id="dai-so-tuyen-tinh">
<h2>4.5 Đại số tuyến tính<a class="headerlink" href="#dai-so-tuyen-tinh" title="Link to this heading">#</a></h2>
<p>Đại số tuyến tính, như nhân ma trận, phân rã, định thức và các hàm toán học ma trận vuông khác, là một phần quan trọng của bất kỳ thư viện mảng nào. Không giống như một số ngôn ngữ như MATLAB, việc nhân hai mảng hai chiều bằng <code class="docutils literal notranslate"><span class="pre">*</span></code> là một phép nhân theo từng phần tử thay vì một phép nhân ma trận. Do đó, có một hàm <code class="docutils literal notranslate"><span class="pre">dot</span></code>, cả dưới dạng một hàm trong không gian tên <code class="docutils literal notranslate"><span class="pre">numpy</span></code> và một phương thức <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>, để thực hiện nhân ma trận:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_linalg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">]])</span>
<span class="n">y_linalg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">23.</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<span class="n">x_linalg</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_linalg</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_linalg</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y_linalg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">x_linalg.dot(y_linalg)</span></code> tương đương với <code class="docutils literal notranslate"><span class="pre">np.dot(x_linalg,</span> <span class="pre">y_linalg)</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x_linalg</span><span class="p">,</span> <span class="n">y_linalg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Một phép nhân ma trận giữa một mảng 2D và một mảng 1D có kích thước phù hợp sẽ dẫn đến một mảng 1D:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x_linalg</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Toán tử <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> cũng hoạt động như một toán tử infix thực hiện nhân ma trận:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_linalg</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">numpy.linalg</span></code> có một tập hợp chuẩn các phép phân rã ma trận và những thứ như nghịch đảo và định thức. Chúng được triển khai dưới các hàm được tìm thấy trong các thư viện đại số tuyến tính tiêu chuẩn ngành như BLAS, LAPACK, hoặc Intel Math Kernel Library (MKL) độc quyền (nếu bạn đã xây dựng NumPy bằng nó).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">numpy.linalg</span><span class="w"> </span><span class="kn">import</span> <span class="n">inv</span><span class="p">,</span> <span class="n">qr</span>
<span class="n">X_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">mat_inv</span> <span class="o">=</span> <span class="n">X_inv</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X_inv</span> <span class="c1"># .T là một bí danh cho transpose</span>
<span class="n">inv</span><span class="p">(</span><span class="n">mat_inv</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mat_inv</span> <span class="o">@</span> <span class="n">inv</span><span class="p">(</span><span class="n">mat_inv</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Hàm <code class="docutils literal notranslate"><span class="pre">inv</span></code> tính toán nghịch đảo của một ma trận vuông. Phép nhân <code class="docutils literal notranslate"><span class="pre">mat_inv</span> <span class="pre">&#64;</span> <span class="pre">inv(mat_inv)</span></code> phải tạo ra ma trận đơn vị (identity matrix) hoặc một ma trận rất gần với nó.</p>
<p>Phân rã QR tính toán phân rã QR của một ma trận:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">qr</span><span class="p">(</span><span class="n">mat_inv</span><span class="p">)</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
</div>
<p>Bảng 4.7 liệt kê một phần các hàm đại số tuyến tính thường được sử dụng. Tham khảo tài liệu của <code class="docutils literal notranslate"><span class="pre">numpy.linalg</span></code> để biết thêm chi tiết.</p>
<p><strong>Bảng 4.7: Các hàm <code class="docutils literal notranslate"><span class="pre">numpy.linalg</span></code> thường được sử dụng</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Hàm</p></th>
<th class="head"><p>Mô tả</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">diag</span></code></p></td>
<td><p>Trả về các phần tử đường chéo (hoặc ngoài đường chéo) của một mảng vuông dưới dạng một mảng 1D, hoặc chuyển đổi một mảng 1D thành một mảng vuông với các phần tử đó trên đường chéo, các phần tử khác bằng không.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dot</span></code></p></td>
<td><p>Nhân ma trận.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">trace</span></code></p></td>
<td><p>Tính tổng các phần tử đường chéo.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">det</span></code></p></td>
<td><p>Tính định thức ma trận.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">eig</span></code></p></td>
<td><p>Tính các giá trị riêng (eigenvalues) và các vector riêng (eigenvectors) của một ma trận vuông.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">inv</span></code></p></td>
<td><p>Tính nghịch đảo của một ma trận vuông.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pinv</span></code></p></td>
<td><p>Tính nghịch đảo giả Moore-Penrose của một ma trận.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qr</span></code></p></td>
<td><p>Tính phân rã QR.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">svd</span></code></p></td>
<td><p>Tính phân rã giá trị suy biến (Singular Value Decomposition - SVD).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">solve</span></code></p></td>
<td><p>Giải hệ phương trình tuyến tính Ax = b cho x, trong đó A là một ma trận vuông.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">lstsq</span></code></p></td>
<td><p>Tính nghiệm bình phương tối thiểu theo phương pháp bình phương tối thiểu cho Ax = b.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="sinh-so-gia-ngau-nhien-pseudorandom-number-generation">
<h2>4.6 Sinh số Giả ngẫu nhiên (Pseudorandom Number Generation)<a class="headerlink" href="#sinh-so-gia-ngau-nhien-pseudorandom-number-generation" title="Link to this heading">#</a></h2>
<p>Mô-đun <code class="docutils literal notranslate"><span class="pre">numpy.random</span></code> bổ sung cho mô-đun <code class="docutils literal notranslate"><span class="pre">random</span></code> tích hợp sẵn của Python bằng các hàm để tạo hiệu quả toàn bộ mảng các giá trị mẫu từ nhiều loại phân phối xác suất. Ví dụ, bạn có thể lấy một mảng 4 × 4 các mẫu từ phân phối chuẩn (trung bình 0, độ lệch chuẩn 1) bằng <code class="docutils literal notranslate"><span class="pre">numpy.random.standard_normal</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samples_rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">samples_rng</span>
</pre></div>
</div>
</div>
</div>
<p>Mô-đun <code class="docutils literal notranslate"><span class="pre">random</span></code> tích hợp sẵn của Python, ngược lại, chỉ lấy mẫu một giá trị tại một thời điểm. Như bạn có thể thấy từ phép đo benchmark này, <code class="docutils literal notranslate"><span class="pre">numpy.random</span></code> nhanh hơn nhiều để tạo ra số lượng lớn các số ngẫu nhiên:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">random</span><span class="w"> </span><span class="kn">import</span> <span class="n">normalvariate</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1_000_000</span>
<span class="c1"># %timeit samples = [normalvariate(0, 1) for _ in range(N)]</span>
<span class="c1"># %timeit np.random.standard_normal(N)</span>

<span class="c1"># Chạy các lệnh trên trong Jupyter Notebook / IPython để thấy kết quả timeit</span>
<span class="c1"># Ví dụ:</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">samples_py_rng</span> <span class="o">=</span> <span class="p">[</span><span class="n">normalvariate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Python random: </span><span class="si">{</span><span class="n">t1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">t0</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> s&quot;</span><span class="p">)</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">samples_np_rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NumPy random: </span><span class="si">{</span><span class="n">t1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">t0</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Chúng ta nói rằng những con số này là <em>giả ngẫu nhiên</em> (pseudorandom) vì chúng được tạo ra bởi một thuật toán với hành vi xác định dựa trên <em>mầm</em> (seed) của trình tạo số ngẫu nhiên. Bạn có thể thay đổi mầm sinh số ngẫu nhiên của NumPy bằng <code class="docutils literal notranslate"><span class="pre">numpy.random.seed</span></code> (cách cũ) hoặc sử dụng <code class="docutils literal notranslate"><span class="pre">numpy.random.default_rng</span></code> (cách mới được khuyến nghị):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">data_rng</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">data_rng</span>
</pre></div>
</div>
</div>
</div>
<p>Trình tạo số ngẫu nhiên (RNG) trong <code class="docutils literal notranslate"><span class="pre">numpy.random</span></code> là một đối tượng lưu trữ trạng thái bên trong. Khi bạn gọi các hàm như <code class="docutils literal notranslate"><span class="pre">rng.standard_normal</span></code>, trình tạo này sẽ nâng cao trạng thái của nó. Bạn có thể lấy một phiên bản trình tạo riêng biệt với các phiên bản khác trong mã của mình:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">data2_rng</span> <span class="o">=</span> <span class="n">rng2</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">data2_rng</span>
</pre></div>
</div>
</div>
</div>
<p>Như bạn có thể thấy, <code class="docutils literal notranslate"><span class="pre">data_rng</span></code> và <code class="docutils literal notranslate"><span class="pre">data2_rng</span></code> là giống hệt nhau. Các hàm dữ liệu trong <code class="docutils literal notranslate"><span class="pre">numpy.random</span></code> (ví dụ, <code class="docutils literal notranslate"><span class="pre">standard_normal</span></code>, <code class="docutils literal notranslate"><span class="pre">uniform</span></code>, <code class="docutils literal notranslate"><span class="pre">randn</span></code>) sử dụng một trình tạo ngẫu nhiên toàn cục, được tạo ngầm. Để có khả năng tái tạo tốt hơn trên các phiên bản NumPy, tôi khuyên bạn nên sử dụng một thể hiện của <code class="docutils literal notranslate"><span class="pre">numpy.random.Generator</span></code>, được tạo bằng <code class="docutils literal notranslate"><span class="pre">numpy.random.default_rng</span></code>.</p>
<p>Xem Bảng 4.8 để biết danh sách một phần các hàm có sẵn trong <code class="docutils literal notranslate"><span class="pre">numpy.random</span></code>. Tôi sẽ quay lại các hàm này trong các ví dụ sau của cuốn sách.</p>
<p><strong>Bảng 4.8: Một số hàm <code class="docutils literal notranslate"><span class="pre">numpy.random</span></code></strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Hàm</p></th>
<th class="head"><p>Mô tả</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">seed</span></code></p></td>
<td><p>Gieo mầm cho trình tạo số ngẫu nhiên. Không được sử dụng với <code class="docutils literal notranslate"><span class="pre">default_rng</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">permutation</span></code></p></td>
<td><p>Trả về một hoán vị ngẫu nhiên của một chuỗi, hoặc trả về một phạm vi đã hoán vị.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">shuffle</span></code></p></td>
<td><p>Hoán vị ngẫu nhiên một chuỗi tại chỗ.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">uniform</span></code></p></td>
<td><p>Rút các mẫu từ một phân phối đều.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">integers</span></code></p></td>
<td><p>Rút các số nguyên ngẫu nhiên từ một phạm vi cho trước.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">standard_normal</span></code></p></td>
<td><p>Rút các mẫu từ một phân phối chuẩn với trung bình 0 và độ lệch chuẩn 1 (dạng ma trận).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">binomial</span></code></p></td>
<td><p>Rút các mẫu từ một phân phối nhị thức.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">normal</span></code></p></td>
<td><p>Rút các mẫu từ một phân phối chuẩn (Gaussian).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">beta</span></code></p></td>
<td><p>Rút các mẫu từ một phân phối beta.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">chisquare</span></code></p></td>
<td><p>Rút các mẫu từ một phân phối chi bình phương.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">gamma</span></code></p></td>
<td><p>Rút các mẫu từ một phân phối gamma.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">poisson</span></code></p></td>
<td><p>Rút các mẫu từ một phân phối Poisson.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rand</span></code></p></td>
<td><p>Rút các mẫu từ một phân phối đều [0, 1).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">randn</span></code></p></td>
<td><p>Rút các mẫu từ một phân phối “chuẩn” bình thường (trung bình 0, độ lệch chuẩn 1).</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="vi-du-buoc-di-ngau-nhien-random-walks">
<h2>4.7 Ví dụ: Bước đi ngẫu nhiên (Random Walks)<a class="headerlink" href="#vi-du-buoc-di-ngau-nhien-random-walks" title="Link to this heading">#</a></h2>
<p>Hãy xem xét một ví dụ ứng dụng đơn giản của việc sử dụng các phép toán mảng: mô phỏng các bước đi ngẫu nhiên. Hãy bắt đầu với trường hợp đơn giản của một bước đi ngẫu nhiên bắt đầu từ 0 với các bước có kích thước 1 và –1 xảy ra với xác suất bằng nhau. Đây là cách triển khai Python thuần túy của một bước đi ngẫu nhiên 1.000 bước đơn lẻ bằng cách sử dụng mô-đun <code class="docutils literal notranslate"><span class="pre">random</span></code> tích hợp sẵn:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="n">position</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">walk</span> <span class="o">=</span> <span class="p">[</span><span class="n">position</span><span class="p">]</span>
<span class="n">nsteps</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsteps</span><span class="p">):</span>
    <span class="n">step</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">position</span> <span class="o">+=</span> <span class="n">step</span>
    <span class="n">walk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Hình 4.4 cho thấy một mẫu của 100 giá trị đầu tiên cho một bước đi ngẫu nhiên này.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">walk</span><span class="p">[:</span><span class="mi">100</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Python Random Walk (first 100 steps)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Hình 4.4: Một bước đi ngẫu nhiên 1D đơn giản</strong></p>
<p>(Hình ảnh hiển thị biểu đồ đường của 100 bước đầu tiên của một bước đi ngẫu nhiên)</p>
<p>Bạn có thể nhận thấy rằng <code class="docutils literal notranslate"><span class="pre">walk</span></code> chỉ đơn giản là tổng tích lũy của các bước ngẫu nhiên và mỗi bước có thể được tạo ra bằng cách sử dụng <code class="docutils literal notranslate"><span class="pre">rng.integers(0,</span> <span class="pre">2)</span></code> để rút ra các giá trị 0 hoặc 1; sau đó, giá trị 0 được biến đổi thành –1. Do đó, tôi có thể diễn đạt điều này dưới dạng một phép toán mảng:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng_walk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span> <span class="c1"># fresh random number generator</span>
<span class="n">nsteps_walk</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">draws_walk</span> <span class="o">=</span> <span class="n">rng_walk</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">nsteps_walk</span><span class="p">)</span> <span class="c1"># 0 hoặc 1</span>
<span class="n">steps_walk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">draws_walk</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">walk_np</span> <span class="o">=</span> <span class="n">steps_walk</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Từ điều này, chúng ta có thể bắt đầu trích xuất các thống kê như giá trị tối thiểu và tối đa đạt được:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">walk_np</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">walk_np</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Một thống kê phức tạp hơn là <em>thời gian chạm lần đầu</em> (first passage time), thời điểm mà bước đi ngẫu nhiên đạt đến một giá trị cụ thể. Ở đây chúng ta có thể muốn biết mất bao lâu để bước đi ngẫu nhiên cách xa điểm gốc (0) ít nhất 10 bước. <code class="docutils literal notranslate"><span class="pre">np.abs(walk_np)</span> <span class="pre">&gt;=</span> <span class="pre">10</span></code> cung cấp cho chúng ta một mảng boolean cho biết vị trí là tại hoặc vượt quá 10, nhưng chúng ta muốn chỉ mục của <code class="docutils literal notranslate"><span class="pre">True</span></code> <em>đầu tiên</em>. Điều này có thể được tính toán bằng <code class="docutils literal notranslate"><span class="pre">argmax</span></code>, trả về chỉ mục đầu tiên của giá trị lớn nhất trong mảng boolean (<code class="docutils literal notranslate"><span class="pre">True</span></code> là giá trị lớn nhất):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">walk_np</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Chú ý:</strong> Lưu ý rằng việc sử dụng <code class="docutils literal notranslate"><span class="pre">argmax</span></code> ở đây không phải lúc nào cũng hiệu quả vì nó luôn quét toàn bộ mảng. Trong trường hợp này, một khi một <code class="docutils literal notranslate"><span class="pre">True</span></code> được quan sát, chúng ta biết đó là giá trị lớn nhất.</p>
</div></blockquote>
<section id="mo-phong-nhieu-buoc-di-ngau-nhien-cung-mot-luc">
<h3>Mô phỏng nhiều bước đi ngẫu nhiên cùng một lúc<a class="headerlink" href="#mo-phong-nhieu-buoc-di-ngau-nhien-cung-mot-luc" title="Link to this heading">#</a></h3>
<p>Nếu mục tiêu của bạn là mô phỏng nhiều bước đi ngẫu nhiên, giả sử 5.000, bạn có thể tạo tất cả các bước đi ngẫu nhiên cùng một lúc với một chút sửa đổi nhỏ cho đoạn mã trước. Nếu bạn truyền một tuple 2 chiều cho các hàm <code class="docutils literal notranslate"><span class="pre">numpy.random</span></code>, nó sẽ tạo ra một mảng 2D các lần rút, và chúng ta có thể tính toán tổng tích lũy trên các hàng (để có được tất cả 5.000 bước đi ngẫu nhiên cùng một lúc):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nwalks</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">nsteps_multi</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">draws_multi</span> <span class="o">=</span> <span class="n">rng_walk</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">nwalks</span><span class="p">,</span> <span class="n">nsteps_multi</span><span class="p">))</span> <span class="c1"># 0 hoặc 1</span>
<span class="n">steps_multi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">draws_multi</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">walks_multi</span> <span class="o">=</span> <span class="n">steps_multi</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">walks_multi</span>
</pre></div>
</div>
</div>
</div>
<p>Bây giờ, chúng ta có thể tính toán giá trị tối đa và tối thiểu thu được trên tất cả các bước đi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">walks_multi</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">walks_multi</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Trong số các bước đi này, hãy tính toán thời gian chạm lần đầu tối thiểu là 30 hoặc –30. Điều này hơi phức tạp vì không phải tất cả 5.000 bước đi đều đạt đến 30. Chúng ta có thể kiểm tra điều này bằng phương thức <code class="docutils literal notranslate"><span class="pre">any</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hits30</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">walks_multi</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">hits30</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hits30</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># Số lượng các bước đi chạm đến 30 hoặc -30</span>
</pre></div>
</div>
</div>
</div>
<p>Chúng ta có thể sử dụng mảng boolean này để chọn ra các hàng của <code class="docutils literal notranslate"><span class="pre">walks_multi</span></code> thực sự vượt qua mức tuyệt đối 30 và gọi <code class="docutils literal notranslate"><span class="pre">argmax</span></code> trên <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> để lấy thời gian chạm qua:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crossing_times</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">walks_multi</span><span class="p">[</span><span class="n">hits30</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">crossing_times</span>
</pre></div>
</div>
</div>
</div>
<p>Cuối cùng, chúng ta có thể tính toán thời gian trung bình tối thiểu để chạm đến 30:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crossing_times</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Hãy thử nghiệm với các phân phối khác cho các bước thay vì chỉ các lần lật đồng xu bằng nhau. Ví dụ, chúng ta có thể sử dụng các bước được rút ra từ một phân phối chuẩn với trung bình 0 và độ lệch chuẩn 0.25:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">steps_normal_dist</span> <span class="o">=</span> <span class="n">rng_walk</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                                     <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">nwalks</span><span class="p">,</span> <span class="n">nsteps_multi</span><span class="p">))</span>
<span class="n">walks_normal_dist</span> <span class="o">=</span> <span class="n">steps_normal_dist</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max value for normal distribution walk: </span><span class="si">{</span><span class="n">walks_normal_dist</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Min value for normal distribution walk: </span><span class="si">{</span><span class="n">walks_normal_dist</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Trong chương này, bạn đã học được những điều cơ bản về cách sử dụng các mảng <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> của NumPy và đã thấy nhiều loại công thức tính toán vector hóa. Trong chương tiếp theo, chúng ta sẽ tìm hiểu về pandas, một thư viện được xây dựng dựa trên NumPy, cung cấp một bộ công cụ hiệu quả và biểu cảm để thao tác và phân tích dữ liệu dạng bảng.</p>
</section>
</section>
<section id="ket-luan">
<h2>4.8 Kết luận<a class="headerlink" href="#ket-luan" title="Link to this heading">#</a></h2>
<p>Trong khi nhiều tính năng của NumPy được sử dụng nội bộ trong pandas và các thư viện khác, việc hiểu rõ hơn về các mảng NumPy và tính toán hướng mảng sẽ giúp bạn sử dụng các công cụ như pandas hiệu quả hơn. Các <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> cung cấp một đối tượng lưu trữ dữ liệu mạnh mẽ, linh hoạt và hiệu suất cao, có thể dễ dàng định hình lại và xử lý bằng nhiều loại thuật toán. Khả năng thực hiện các phép toán toán học phức tạp trên toàn bộ khối dữ liệu mà không cần viết vòng lặp <code class="docutils literal notranslate"><span class="pre">for</span></code> làm cho NumPy trở thành một thành phần trung tâm trong hệ sinh thái tính toán khoa học của Python.</p>
<p>Tiếp theo, chúng ta sẽ đi sâu vào pandas, nơi chúng ta sẽ áp dụng nhiều khái niệm này vào các tình huống phân tích dữ liệu thực tế hơn.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Đoạn mã dọn dẹp các tệp đã tạo (nếu có)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;some_array.npy&quot;</span><span class="p">):</span> 
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;some_array.npy&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Đã xóa some_array.npy&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;array_archive.npz&quot;</span><span class="p">):</span> 
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;array_archive.npz&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Đã xóa array_archive.npz&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;arrays_compressed.npz&quot;</span><span class="p">):</span> 
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;arrays_compressed.npz&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Đã xóa arrays_compressed.npz&quot;</span><span class="p">)</span>
<span class="c1"># if os.path.exists(&quot;array_ex.txt&quot;): </span>
<span class="c1">#     os.remove(&quot;array_ex.txt&quot;)</span>
<span class="c1">#     print(&quot;Đã xóa array_ex.txt&quot;)</span>
<span class="c1"># if os.path.exists(&quot;my_array_saved.csv&quot;): </span>
<span class="c1">#     os.remove(&quot;my_array_saved.csv&quot;)</span>
<span class="c1">#     print(&quot;Đã xóa my_array_saved.csv&quot;)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="chapter4-basics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chương 4: Python cơ bản</p>
      </div>
    </a>
    <a class="right-next"
       href="chapter6-pandas.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chương 6: Giới thiệu về <code class="docutils literal notranslate"><span class="pre">pandas</span></code></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#doi-tuong-ndarray-cua-numpy">Đối tượng <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> của NumPy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tao-mot-ndarray">Tạo một ndarray</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kieu-du-lieu-cho-ndarray">Kiểu dữ liệu cho ndarray</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-phep-toan-so-hoc-voi-mang-numpy">Các phép toán số học với mảng <code class="docutils literal notranslate"><span class="pre">NumPy</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-so-cua-mang">Chỉ số của mảng</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-muc-hoa-bang-lat-cat-indexing-with-slices">Chỉ mục hóa bằng lát cắt (Indexing with Slices)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-muc-hoa-boolean-boolean-indexing">Chỉ mục hóa Boolean (Boolean Indexing)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-muc-hoa-nang-cao-fancy-indexing">Chỉ mục hóa nâng cao (Fancy Indexing)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chuyen-vi-mang-va-hoan-doi-truc-transposing-arrays-and-swapping-axes">Chuyển vị mảng và Hoán đổi trục (Transposing Arrays and Swapping Axes)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ham-pho-quat-cac-ham-mang-tinh-toan-theo-tung-phan-tu-nhanh-chong">4.2 Hàm phổ quát: Các hàm mảng tính toán theo từng phần tử nhanh chóng</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xu-ly-du-lieu-dua-tren-mang">4.3 Xử lý dữ liệu dựa trên mảng</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-hien-logic-co-dieu-kien-duoi-dang-cac-phep-toan-mang">Thể hiện logic có điều kiện dưới dạng các phép toán mảng</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-phuong-thuc-thong-ke-toan-hoc">Các phương thức thống kê toán học</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-phuong-thuc-cho-mang-boolean">Các phương thức cho mảng Boolean</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sap-xep-sorting">Sắp xếp (Sorting)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cac-phep-toan-tap-hop-set-operations-cho-mang-1d">Các phép toán tập hợp (Set Operations) cho Mảng 1D</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nhap-va-xuat-file-voi-mang">4.4 Nhập và Xuất file với Mảng</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#luu-va-tai-tep-van-ban">Lưu và tải tệp văn bản</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dai-so-tuyen-tinh">4.5 Đại số tuyến tính</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sinh-so-gia-ngau-nhien-pseudorandom-number-generation">4.6 Sinh số Giả ngẫu nhiên (Pseudorandom Number Generation)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vi-du-buoc-di-ngau-nhien-random-walks">4.7 Ví dụ: Bước đi ngẫu nhiên (Random Walks)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mo-phong-nhieu-buoc-di-ngau-nhien-cung-mot-luc">Mô phỏng nhiều bước đi ngẫu nhiên cùng một lúc</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ket-luan">4.8 Kết luận</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Trường Công nghệ, Đại học Kinh tế Quốc dân
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>